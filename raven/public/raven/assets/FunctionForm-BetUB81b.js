var ye=Object.defineProperty,fe=Object.defineProperties;var ve=Object.getOwnPropertyDescriptors;var re=Object.getOwnPropertySymbols;var be=Object.prototype.hasOwnProperty,_e=Object.prototype.propertyIsEnumerable;var ie=(t,i,c)=>i in t?ye(t,i,{enumerable:!0,configurable:!0,writable:!0,value:c}):t[i]=c,_=(t,i)=>{for(var c in i||(i={}))be.call(i,c)&&ie(t,c,i[c]);if(re)for(var c of re(i))_e.call(i,c)&&ie(t,c,i[c]);return t},S=(t,i)=>fe(t,ve(i));import{r as f,j as e,S as p,ax as g,p as C,L as O,aD as Q,aE as X,aF as Z,aG as N,i as v,aS as te,b as le,aH as q,bu as R,ay as Ce,o as k,aJ as w,aP as G,a3 as De,aA as E,n as I,c4 as ue,aN as de,O as ee,a6 as V,a8 as se,aa as J,ab as he,au as U,av as Y,aM as ne,aK as we,aj as Se,M as Ne,a7 as qe,c2 as Fe,c5 as Oe,b8 as Te,c6 as H,c7 as K,c as L,aL as Ae}from"./index-93kECIxS.js";import{b as T}from"./validations-DJFqvO1k.js";import{i as Ee}from"./switch-txWPlp9Y.js";import{A as ke}from"./AINotEnabledCallout-DHulyDzA.js";import{u as me}from"./useDoctypeMeta-C0Qoed5I.js";import{D as pe}from"./DoctypeVariableDialogForm-OfptV_xQ.js";import{m as $e,b as ze,P as ae,f as oe}from"./tabs-DsY8ua36.js";const M=[{value:"Get Document",description:"Fetch any document from the system.",requires_write_permissions:!1,type:"Standard"},{value:"Get Multiple Documents",description:"Fetch multiple document from the system",requires_write_permissions:!1,type:"Bulk Operations"},{value:"Get List",description:"Fetch a list of documents from the system (using filters).",requires_write_permissions:!1,type:"Standard"},{value:"Get Value",description:"Get a single value or multiple values from a document in the system using filters.",requires_write_permissions:!1,type:"Standard"},{value:"Set Value",description:"Set a value in a document in the system. This function can set a single value or multiple values in a document.",requires_write_permissions:!0,type:"Standard"},{value:"Create Document",description:"Create any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Create Multiple Documents",description:"Create multiple documents in the system in one go.",requires_write_permissions:!0,type:"Bulk Operations"},{value:"Update Document",description:"Update any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Update Multiple Documents",description:"Update multiple documents in the system in one go.",requires_write_permissions:!0,type:"Bulk Operations"},{value:"Delete Document",description:"Delete any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Delete Multiple Documents",description:"Delete multiple documents in the system in one go.",requires_write_permissions:!0,type:"Bulk Operations"},{value:"Submit Document",description:"Submit any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Cancel Document",description:"Cancel any document in the system.",requires_write_permissions:!0,type:"Standard"},{value:"Get Amended Document",description:"Get the amended document for a given document. This function is only available for documents that have been cancelled and then amended.",requires_write_permissions:!1,type:"Standard"},{value:"Custom Function",description:"Custom function to be used in the system.",type:"Other"},{value:"Attach File to Document",description:"Attach a file to any document.",requires_write_permissions:!0,type:"Other"},{value:"Get Report Result",description:"Allows the bot to get the result of any report in the system.",requires_write_permissions:!1,type:"Other"}],xe=({defaultValues:t,onAdd:i,allowNameChange:c,name:o,defaultRequired:r})=>{var z,x,F;const[l,d]=f.useState((t==null?void 0:t.type)||"string"),[h,a]=f.useState(o!=null?o:""),[n,u]=f.useState((z=t==null?void 0:t.description)!=null?z:""),[s,m]=f.useState(r!=null?r:!1),[j,D]=f.useState((t==null?void 0:t.type)==="string"||(t==null?void 0:t.type)==="number"?(x=t==null?void 0:t.enum)!=null?x:[]:[]),[b,A]=f.useState((t==null?void 0:t.type)==="array"?(F=t==null?void 0:t.items)!=null?F:[]:void 0),$=!h||!l||!n,B=()=>{i(h,{type:l,description:n,enum:j.length>0?j:void 0,items:l==="array"?b:void 0},s)};return e.jsxs(p,{gap:"4",pt:"2",children:[e.jsxs(p,{gap:"4",className:"max-h-[75vh] overflow-y-auto",children:[e.jsxs(g,{children:[e.jsxs(p,{width:"50%",gap:"4",children:[e.jsxs(C,{children:[e.jsx(O,{isRequired:!0,children:"Type"}),e.jsxs(Q,{required:!0,value:l,onValueChange:y=>d(y),children:[e.jsx(X,{placeholder:"Select a variable type",className:"w-full"}),e.jsxs(Z,{children:[e.jsx(N,{value:"string",children:"String"}),e.jsx(N,{value:"array",children:"Array"}),e.jsx(N,{value:"number",children:"Number"}),e.jsx(N,{value:"boolean",children:"Boolean"}),e.jsx(N,{value:"object",children:"Object"})]})]})]}),e.jsx(C,{children:e.jsx(v,{as:"label",size:"2",children:e.jsxs(g,{children:[e.jsx(te,{checked:s,onCheckedChange:y=>m(!!y)}),"Required"]})})})]}),e.jsxs(p,{width:"50%",children:[e.jsxs(C,{children:[e.jsx(O,{isRequired:!0,children:"Name"}),e.jsx(le,{name:"name",value:h,required:!0,readOnly:!c,onChange:y=>{var P;return a((P=y.target.value)==null?void 0:P.replace(/\s/g,"_"))}})]}),e.jsx(q,{children:"Variable name must be unique, and cannot have spaces."})]})]}),l==="array"&&e.jsxs(C,{width:"50%",children:[e.jsx(O,{isRequired:!0,children:"Type of items in the array"}),e.jsxs(Q,{value:b==null?void 0:b.type,onValueChange:y=>A(P=>S(_({},P),{type:y})),children:[e.jsx(X,{placeholder:"Select a variable type",className:"w-full"}),e.jsxs(Z,{children:[e.jsx(N,{value:"string",children:"String"}),e.jsx(N,{value:"number",children:"Number"})]})]})]}),e.jsxs(C,{children:[e.jsx(O,{htmlFor:"description",isRequired:!0,children:"Description"}),e.jsx(R,{name:"description",required:!0,value:n,onChange:y=>u(y.target.value),placeholder:"Enter a description for this variable"})]}),(l==="string"||l==="number")&&e.jsx(p,{children:e.jsxs(p,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"enumValues",children:"Options"}),e.jsx(R,{rows:7,resize:"vertical",name:"enumValues",value:j.join(`
`),onChange:y=>D(y.target.value.split(`
`))})]}),e.jsx(q,{children:"Add a new option on a new line. If you want this variable to have a default value, just add one option."})]})})]}),e.jsxs(g,{justify:"end",children:[e.jsx(Ce,{children:e.jsx(k,{variant:"soft",color:"gray",children:"Close"})}),e.jsx(k,{onClick:B,disabled:$,children:"Add"})]})]})},Me=f.createContext(null),W={didCatch:!1,error:null};class Le extends f.Component{constructor(i){super(i),this.resetErrorBoundary=this.resetErrorBoundary.bind(this),this.state=W}static getDerivedStateFromError(i){return{didCatch:!0,error:i}}resetErrorBoundary(){const{error:i}=this.state;if(i!==null){for(var c,o,r=arguments.length,l=new Array(r),d=0;d<r;d++)l[d]=arguments[d];(c=(o=this.props).onReset)===null||c===void 0||c.call(o,{args:l,reason:"imperative-api"}),this.setState(W)}}componentDidCatch(i,c){var o,r;(o=(r=this.props).onError)===null||o===void 0||o.call(r,i,c)}componentDidUpdate(i,c){const{didCatch:o}=this.state,{resetKeys:r}=this.props;if(o&&c.error!==null&&Re(i.resetKeys,r)){var l,d;(l=(d=this.props).onReset)===null||l===void 0||l.call(d,{next:r,prev:i.resetKeys,reason:"keys"}),this.setState(W)}}render(){const{children:i,fallbackRender:c,FallbackComponent:o,fallback:r}=this.props,{didCatch:l,error:d}=this.state;let h=i;if(l){const a={error:d,resetErrorBoundary:this.resetErrorBoundary};if(typeof c=="function")h=c(a);else if(o)h=f.createElement(o,a);else if(r!==void 0)h=r;else throw d}return f.createElement(Me.Provider,{value:{didCatch:l,error:d,resetErrorBoundary:this.resetErrorBoundary}},h)}}function Re(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:[],i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];return t.length!==i.length||t.some((c,o)=>!Object.is(c,i[o]))}const je=t=>{switch(t){case"integer":return{children:"Integer",color:"blue"};case"number":return{children:"Number",color:"purple"};case"float":return{children:"Float",color:"violet"};case"string":return{children:"String",color:"green"};case"boolean":return{children:"Boolean",color:"pink"};case"object":return{children:"Object",color:"orange"};case"array":return{children:"Array",color:"sky"};case"null":return{children:"Null",color:"gray"}}},Ge=t=>{const{control:i,getValues:c,setValue:o,watch:r}=w(),l=r("type"),[d,h]=f.useState("builder"),[a,n]=f.useState(void 0),u=()=>{try{const s=c("params"),m=typeof s=="string"?JSON.parse(s):s;o("params",JSON.stringify(m,null,4))}catch(s){De.error("Error formatting JSON. Please check your JSON."),n(s.message)}};return l!=="Custom Function"?null:e.jsx(C,{className:"py-2",children:e.jsxs(p,{children:[e.jsxs(g,{justify:"between",align:"start",children:[e.jsxs(g,{align:"center",children:[e.jsx(v,{weight:"medium",size:"2",children:"Builder"}),e.jsx(Ee,{size:"2",checked:d==="json",onCheckedChange:s=>h(s?"json":"builder")}),e.jsx(v,{weight:"medium",size:"2",children:"JSON"})]}),d==="json"&&e.jsx(k,{color:"gray",className:"not-cal font-medium",variant:"soft",type:"button",onClick:u,children:"Format JSON"})]}),a&&e.jsx(v,{size:"2",color:"red",children:a}),e.jsx(G,{control:i,name:"params",render:({field:s})=>{if(d==="builder")try{const m=typeof s.value=="string"?JSON.parse(s.value):s.value;return e.jsx(Le,{fallback:e.jsx(v,{size:"2",color:"red",children:"Error loading variables in the builder. Please check your JSON structure."}),children:e.jsx(ge,{json:m,onChange:j=>s.onChange(JSON.stringify(j,null,4))})})}catch(m){return e.jsx(v,{size:"2",color:"red",children:"Error loading variables in the builder. Please check your JSON structure."})}else return e.jsx(R,{rows:30,spellCheck:!1,className:"font-mono bg-gray-2 dark:bg-gray-1 text-amber-900 dark:text-amber-100",resize:"vertical",value:s.value,onChange:m=>s.onChange(m.target.value)})}})]})})},ge=({json:t,onChange:i,isNested:c})=>{const[o,r]=f.useState(void 0),l=t.properties||{},d=(a,n,u)=>{var m,j,D;let s=(m=t.required)!=null?m:[];u&&!T((j=t.required)!=null?j:[],a)&&s.push(a),!u&&T((D=t.required)!=null?D:[],a)&&(s=s.filter(b=>b!==a)),i({type:"object",properties:S(_({},l),{[a]:n}),required:s})},h=a=>{var s;const n=_({},l);delete n[a];const u=(s=t.required)==null?void 0:s.filter(m=>m!==a);i({type:"object",properties:n,required:u})};return e.jsxs(p,{children:[e.jsxs(p,{gap:"1",children:[Object.entries(l).length===0&&e.jsx(v,{size:"2",color:"gray",className:"text-center pt-4",children:"No variables defined"}),Object.entries(l).map(([a,n])=>{var u,s;return e.jsxs(p,{className:"bg-gray-2 dark:bg-gray-4 p-2.5 rounded-md shadow-sm hover:bg-gray-3 dark:hover:bg-gray-5",children:[e.jsxs(g,{justify:"between",align:"center",children:[e.jsxs(p,{gap:"1",children:[e.jsxs(g,{align:"center",children:[e.jsx(v,{className:"font-semibold",size:"2",children:a}),e.jsxs(g,{children:[e.jsx(E,S(_({},je(n.type)),{className:"rounded-md"})),T((u=t.required)!=null?u:[],a)&&e.jsx(E,{color:"red",className:"rounded-md",children:"Required"})]})]}),e.jsx(v,{size:"2",color:"gray",children:n.description}),(n.type==="string"||n.type==="number")&&n.enum&&n.enum.length>0&&e.jsxs(v,{as:"span",size:"2",color:"gray",weight:"medium",children:["Options: ",(s=n.enum)==null?void 0:s.join(", ")]})]}),e.jsxs(g,{align:"center",pr:"2",gap:"4",children:[e.jsx(I,{size:"2",color:"gray",variant:"ghost",type:"button",onClick:()=>r({name:a,properties:n}),children:e.jsx(ue,{size:"16",className:"text-gray-10"})}),e.jsx(I,{size:"2",color:"red",variant:"ghost",type:"button",onClick:()=>h(a),children:e.jsx(de,{size:"16"})})]})]}),n.type==="object"&&e.jsxs(p,{children:[e.jsx(ee,{className:"w-full"}),e.jsx(C,{ml:"8",p:"2",className:"bg-white dark:bg-gray-2 rounded-md",children:e.jsx(ge,{isNested:!0,json:n,onChange:m=>d(a,m)})})]})]},a)}),e.jsx(g,{py:"3",justify:c?"center":"start",children:e.jsx(Be,{onAdd:d})})]}),e.jsx(Pe,{variable:o,onSubmit:d,isOpen:o!==void 0,onOpenChange:a=>!a&&r(void 0)})]})},Be=({onAdd:t,buttonProps:i})=>{const[c,o]=f.useState(!1),r=(l,d,h)=>{t(l,d,h),o(!1)};return e.jsxs(V,{open:c,onOpenChange:o,children:[e.jsx(se,{children:e.jsx(k,S(_({size:"2",variant:"soft"},i),{children:"Add Variable"}))}),e.jsxs(J,{className:he,children:[e.jsx(U,{children:"Add Variable"}),e.jsx(Y,{children:"Add a new variable to your function schema."}),e.jsx(xe,{onAdd:r,allowNameChange:!0})]})]})},Pe=({variable:t,onSubmit:i,isOpen:c,onOpenChange:o})=>{const r=(l,d,h)=>{i(l,d,h),o(!1)};return e.jsx(V,{open:c,onOpenChange:o,children:e.jsxs(J,{className:he,children:[e.jsx(U,{children:"Edit Variable"}),e.jsx(ne,{children:e.jsx(Y,{children:"Edit the variable to your function schema."})}),e.jsx(xe,{onAdd:r,allowNameChange:!1,defaultValues:t==null?void 0:t.properties,defaultRequired:t==null?void 0:t.required,name:t==null?void 0:t.name})]})})},Ie=t=>{const{control:i,getValues:c,setValue:o,watch:r}=w(),l=r("type"),d=r("reference_doctype");return T(["Create Document","Update Document","Create Multiple Documents","Update Multiple Documents"],l)&&d?e.jsx(Ve,{doctype:d}):null},Ve=({doctype:t})=>{const{control:i}=w(),{fields:c,append:o,remove:r,update:l}=we({control:i,name:"parameters"}),d=h=>{o(h)};return e.jsxs(p,{children:[e.jsxs(g,{justify:"end",align:"center",children:[e.jsx(He,{doctype:t,append:d}),e.jsx(Ue,{onAdd:d,doctype:t})]}),e.jsx(p,{children:c.map((h,a)=>e.jsx(Je,{field:h,index:a,update:l,remove:r,doctype:t},h.id))})]})},Je=({field:t,index:i,remove:c,doctype:o,update:r})=>{const{doc:l}=me(o),d=n=>{r(i,n)},{options:h,type:a}=f.useMemo(()=>{var n,u;if(t.child_table_name){const s=(n=l==null?void 0:l.fields)==null?void 0:n.find(m=>m.fieldname===t.child_table_name);return{options:s==null?void 0:s.options,type:s==null?void 0:s.fieldtype}}else{const s=(u=l==null?void 0:l.fields)==null?void 0:u.find(m=>m.fieldname===t.fieldname);return{label:s==null?void 0:s.label,options:s==null?void 0:s.options,type:s==null?void 0:s.fieldtype}}},[t.child_table_name,t.fieldname,l]);return e.jsx(Se,{className:Ne({"bg-gray-6":t.do_not_ask_ai}),children:e.jsxs(g,{justify:"between",children:[e.jsxs(p,{children:[e.jsxs(g,{align:"center",gap:"2",children:[e.jsx(v,{className:"font-semibold",size:"2",children:t.fieldname}),e.jsx(ee,{orientation:"vertical"}),e.jsxs(g,{align:"center",children:[e.jsx(E,S(_({},je(t.type)),{className:"rounded-md"})),t.required?e.jsx(E,{color:"red",className:"rounded-md",children:"Required"}):null,t.options?e.jsx(qe,{content:t.options.split(`
`).join(", "),children:e.jsxs(E,{color:"blue",className:"rounded-md",children:[t.options.split(`
`).length," Options"]})}):null,t.do_not_ask_ai?e.jsx(E,{color:"gray",className:"rounded-md",children:"Do not ask AI"}):null]})]}),e.jsx(v,{size:"2",children:t.description}),e.jsxs(g,{align:"center",gap:"2",children:[t.default_value?e.jsxs(v,{size:"2",color:"gray",children:["Default Value: ",t.default_value]}):null,t.default_value&&t.child_table_name?e.jsx(ee,{orientation:"vertical"}):null,t.child_table_name&&T(["Table","Table MultiSelect"],a)?e.jsxs(v,{size:"2",color:"gray",children:["Child Table: ",h," (",t.child_table_name,")"]}):null]})]}),e.jsxs(g,{align:"center",pr:"2",gap:"4",children:[e.jsx(Ye,{onEdit:d,field:t,doctype:o}),e.jsx(I,{size:"2",color:"red",variant:"ghost",type:"button",onClick:()=>c(i),children:e.jsx(de,{size:"16"})})]})]})})},Ue=({onAdd:t,doctype:i})=>{const[c,o]=f.useState(!1),r=l=>{t(l),o(!1)};return e.jsxs(V,{open:c,onOpenChange:o,children:[e.jsx(se,{children:e.jsx(k,{variant:"solid",type:"button",className:"not-cal",children:"Add"})}),e.jsxs(J,{children:[e.jsx(U,{children:"Add Variable"}),e.jsx(ne,{children:e.jsx(Y,{children:"Add a new variable in the function."})}),e.jsx(pe,{doctype:i,onAdd:r})]})]})},Ye=({onEdit:t,field:i,doctype:c})=>{const[o,r]=f.useState(!1),l=d=>{t(d),r(!1)};return e.jsxs(V,{open:o,onOpenChange:r,children:[e.jsx(se,{children:e.jsx(I,{size:"2",color:"gray",variant:"ghost",type:"button",children:e.jsx(ue,{size:"16",className:"text-gray-10"})})}),e.jsxs(J,{children:[e.jsx(U,{children:"Edit Variable"}),e.jsx(ne,{children:e.jsxs(Y,{children:["Edit variable - ",i.fieldname," in the function."]})}),e.jsx(pe,{doctype:c,onAdd:l,defaultValues:i})]})]})},He=({doctype:t,append:i})=>{const{getValues:c,setValue:o}=w(),{doc:r,childDocs:l}=me(t),d=(n,u)=>{var D,b,A;let s=(b=(D=n.label)!=null?D:n.fieldname)!=null?b:"",m="",j="string";return n.fieldtype==="Select"&&(m=(A=n.options)!=null?A:""),T(["Int","Rating"],n.fieldtype)&&(j="integer"),T(["Float","Currency","Percent"],n.fieldtype)&&(j="number"),n.fieldtype==="Percent"&&(s=`${n.label} in percentage (between 0 and 100)`),n.fieldtype==="Check"&&(j="boolean"),n.fieldtype==="Date"&&(s=`${n.label} in YYYY-MM-DD format`),n.fieldtype==="Datetime"&&(s=`${n.label} in YYYY-MM-DD HH:mm:ss format`),n.fieldtype==="Time"&&(s=`${n.label} in HH:mm:ss format`),u&&(s+=` in ${u}`),{fieldname:n.fieldname,description:s,options:m,type:j,required:n.reqd}},h=(n,u)=>{var m;const s=l==null?void 0:l.find(j=>j.name===n);return s?((m=s.fields)==null?void 0:m.filter(j=>j.reqd).map(j=>S(_({},d(j,s.name)),{child_table_name:u})))||[]:[]},a=()=>{var B,z;const n=c("parameters")||[],u=(B=r==null?void 0:r.fields)==null?void 0:B.filter(x=>x.reqd),s=u==null?void 0:u.filter(x=>x.fieldtype!=="Table"&&x.fieldtype!=="Table MultiSelect"),m=n.map(x=>x.fieldname),j=(s==null?void 0:s.filter(x=>{var F;return!m.includes((F=x.fieldname)!=null?F:"")}).map(x=>d(x)))||[],D=u==null?void 0:u.filter(x=>x.fieldtype==="Table"||x.fieldtype==="Table MultiSelect"),b=((z=D==null?void 0:D.map(x=>{var F,y;return h((F=x.options)!=null?F:"",(y=x.fieldname)!=null?y:"")}))!=null?z:[]).flat(),A=b==null?void 0:b.filter(x=>!n.some(y=>y.fieldname===x.fieldname&&y.child_table_name===x.child_table_name)),$=[...j,...A];$==null||$.forEach(x=>{i(x)})};return e.jsxs(k,{variant:"outline",type:"button",className:"not-cal",onClick:a,children:["Import fields from ",t]})},ce={size:18,className:"mr-1.5"},ut=({isEdit:t})=>{const{watch:i}=w(),c=i("type");return e.jsxs($e,{defaultValue:"function_details",children:[e.jsxs(ze,{children:[e.jsxs(ae,{value:"function_details",children:[e.jsx(Fe,_({},ce))," Details"]}),e.jsxs(ae,{value:"variables",disabled:T(["Get Document","Get Multiple Documents","Delete Document","Delete Multiple Documents","Attach File to Document","Submit Document","Cancel Document","Get Amended Document"],c),children:[e.jsx(Oe,_({},ce))," Variables"]})]}),e.jsxs(p,{pt:"4",children:[e.jsx(ke,{}),e.jsx(oe,{value:"function_details",children:e.jsx(Ke,{isEdit:t})}),e.jsx(oe,{value:"variables",children:e.jsx(We,{})})]})]})},Ke=({isEdit:t})=>{var d,h,a;const{register:i,control:c,formState:{errors:o},setValue:r}=w(),l=n=>{const u=M.find(s=>s.value===n.target.value);n.target.value==="Attach File to Document"&&(r("reference_doctype",""),r("function_name","attach_file_to_document"),r("description","This function attaches a file to a document in the system. Call this function after you have created or updated the document.")),u&&(u.requires_write_permissions!==void 0&&r("requires_write_permissions",u.requires_write_permissions?1:0),u.value!=="Custom Function"&&r("function_path",""))};return e.jsxs(p,{gap:"4",children:[e.jsxs(Te,{columns:"2",gap:"4",children:[e.jsxs(p,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"type",isRequired:!0,children:"Type"}),e.jsx(G,{control:c,name:"type",rules:{required:"Type is required",onChange:l},render:({field:n})=>e.jsxs(Q,{value:n.value,name:n.name,onValueChange:u=>n.onChange(u),children:[e.jsx(X,{placeholder:"Pick a function type",className:"w-full",autoFocus:!0}),e.jsxs(Z,{children:[e.jsxs(H,{children:[e.jsx(K,{className:"pl-3",children:"Standard"}),M.filter(u=>u.type==="Standard").map(u=>e.jsx(N,{value:u.value,children:u.value},u.value))]}),e.jsxs(H,{children:[e.jsx(K,{className:"pl-3",children:"Miscellaneous"}),M.filter(u=>u.type==="Other").map(u=>e.jsx(N,{value:u.value,children:u.value},u.value))]}),e.jsxs(H,{children:[e.jsx(K,{className:"pl-3",children:"Bulk Operations"}),M.filter(u=>u.type==="Bulk Operations").map(u=>e.jsx(N,{value:u.value,children:u.value},u.value))]})]})]})})]}),e.jsx(Qe,{}),o.type&&e.jsx(L,{children:(d=o.type)==null?void 0:d.message})]}),e.jsx(tt,{}),e.jsxs(p,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"function_name",isRequired:!0,children:"Name"}),e.jsx(le,S(_({id:"function_name"},i("function_name",{required:"Name is required",disabled:t,validate:n=>n.includes(" ")?"Name cannot contain spaces":!0})),{readOnly:t,placeholder:"get_purchase_invoice","aria-invalid":o.function_name?"true":"false"}))]}),o.function_name&&e.jsx(L,{children:(h=o.function_name)==null?void 0:h.message}),e.jsx(q,{children:"This needs to be unique and cannot contain spaces."})]})]}),e.jsxs(p,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"description",isRequired:!0,children:"Description"}),e.jsx(G,{control:c,name:"description",render:({field:n})=>e.jsx(R,S(_({id:"description"},n),{placeholder:"Describe what this function does."}))})]}),o.description&&e.jsx(L,{children:(a=o.description)==null?void 0:a.message}),e.jsx(q,{children:"This is used to describe what this function does to the AI Agent."})]}),e.jsx(et,{}),e.jsx(Ze,{})]})},We=()=>e.jsxs(e.Fragment,{children:[e.jsx(Ie,{}),e.jsxs(p,{children:[e.jsx(Xe,{}),e.jsx(Ge,{})]})]}),Qe=()=>{const{watch:t}=w(),i=t("type"),c=M.find(o=>o.value===i);return c?e.jsx(q,{children:c.description}):e.jsx(q,{children:"Select a function type from the dropdown above."})},Xe=()=>{const{watch:t,control:i}=w();return t("type")!=="Custom Function"?null:e.jsxs(p,{maxWidth:"480px",children:[e.jsx(v,{as:"label",size:"2",children:e.jsxs(g,{children:[e.jsx(G,{control:i,name:"pass_parameters_as_json",render:({field:o})=>e.jsx(te,{checked:!!o.value,onCheckedChange:r=>o.onChange(r?1:0)})}),"Pass parameters as JSON"]})}),e.jsx(q,{children:"If checked, the params will be passed as a JSON object instead of named parameters"})]})},Ze=()=>{const{watch:t,control:i}=w(),c=t("type");return e.jsxs(p,{maxWidth:"480px",children:[e.jsx(v,{as:"label",size:"2",children:e.jsxs(g,{children:[e.jsx(G,{control:i,name:"requires_write_permissions",render:({field:o})=>e.jsx(te,{disabled:c!=="Custom Function",checked:!!o.value,onCheckedChange:r=>o.onChange(r?1:0)})}),"Requires Write Permissions"]})}),e.jsx(q,{children:"Check this if the function you have selected requires write permissions."})]})},et=()=>{var r;const{register:t,watch:i,formState:{errors:c}}=w(),o=i("type");return o!=="Custom Function"?null:e.jsxs(p,{children:[e.jsxs(C,{children:[e.jsx(O,{htmlFor:"function_path",isRequired:o==="Custom Function",children:"Custom Function Path"}),e.jsx(R,S(_({id:"function_path"},t("function_path",{required:o==="Custom Function"?"Path is required":!1,validate:l=>l!=null&&l.includes(" ")?"Path cannot contain spaces":!0})),{placeholder:"myapp.api.my_custom_function"}))]}),e.jsx(q,{children:"Dotted path to the custom function/API. Cannot contain spaces."}),c.function_path&&e.jsx(L,{children:(r=c.function_path)==null?void 0:r.message})]})},tt=()=>{var h;const{watch:t,formState:{errors:i},setValue:c,getValues:o}=w(),r=t("type"),l=["Get Document","Get Multiple Documents","Get List","Get Value","Set Value","Create Document","Create Multiple Documents","Update Document","Update Multiple Documents","Delete Document","Delete Multiple Documents","Submit Document","Cancel Document","Get Amended Document"],d=a=>{if(a.target.value){let n="";const u=!!o("function_name");let s="";r==="Get Document"&&(n=`This function fetches a ${a.target.value} document using its name from the system.`,s=`get_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),r==="Get Multiple Documents"&&(n=`This function fetches multiple ${a.target.value} documents using their names from the system.`,s=`get_${a.target.value.toLowerCase().replace(/\s/g,"_")}s`),r==="Get List"&&(n=`This function fetches a list of ${a.target.value} from the system.`,s=`get_${a.target.value.toLowerCase().replace(/\s/g,"_")}_list`),r==="Get Value"&&(n=`This function fetches a value from a ${a.target.value} in the system.`,s=`get_${a.target.value.toLowerCase().replace(/\s/g,"_")}_value`),r==="Set Value"&&(n=`This function sets a value in a ${a.target.value} in the system.`,s=`set_${a.target.value.toLowerCase().replace(/\s/g,"_")}_value`),r==="Create Document"&&(n=`This function creates a ${a.target.value} in the system.`,s=`create_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),r==="Create Multiple Documents"&&(n=`This function creates multiple ${a.target.value} in the system.`,s=`create_${a.target.value.toLowerCase().replace(/\s/g,"_")}s`),r==="Update Document"&&(n=`This function updates a ${a.target.value} in the system.`,s=`update_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),r==="Update Multiple Documents"&&(n=`This function updates multiple ${a.target.value} in the system.`,s=`update_${a.target.value.toLowerCase().replace(/\s/g,"_")}s`),r==="Delete Document"&&(n=`This function deletes a ${a.target.value} from the system.`,s=`delete_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),r==="Delete Multiple Documents"&&(n=`This function deletes multiple ${a.target.value} from the system.`,s=`delete_${a.target.value.toLowerCase().replace(/\s/g,"_")}s`),r==="Submit Document"&&(n=`This function submits a ${a.target.value} in the system.`,s=`submit_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),r==="Cancel Document"&&(n=`This function cancels a ${a.target.value} in the system.`,s=`cancel_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),r==="Get Amended Document"&&(n=`This function gets the amended document for a ${a.target.value} in the system.`,s=`get_amended_${a.target.value.toLowerCase().replace(/\s/g,"_")}`),s&&!u&&c("function_name",s),n&&c("description",n)}};return l.includes(r)?e.jsxs(p,{children:[e.jsx(Ae,{name:"reference_doctype",label:"Reference Doctype",required:!0,filters:[["istable","=",0],["issingle","=",0]],doctype:"DocType",rules:{required:l.includes(r)?"Reference Doctype is required":!1,onChange:d}}),e.jsx(q,{children:"The document you want this function to operate on."}),i.reference_doctype&&e.jsx(L,{children:(h=i.reference_doctype)==null?void 0:h.message})]}):null};export{ut as F};
