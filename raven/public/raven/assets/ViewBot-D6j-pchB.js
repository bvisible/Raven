var g=Object.defineProperty,y=Object.defineProperties;var S=Object.getOwnPropertyDescriptors;var p=Object.getOwnPropertySymbols;var C=Object.prototype.hasOwnProperty,w=Object.prototype.propertyIsEnumerable;var u=(e,t,o)=>t in e?g(e,t,{enumerable:!0,configurable:!0,writable:!0,value:o}):e[t]=o,h=(e,t)=>{for(var o in t||(t={}))C.call(t,o)&&u(e,o,t[o]);if(p)for(var o of p(t))w.call(t,o)&&u(e,o,t[o]);return e},x=(e,t)=>y(e,S(t));import{bx as B,by as E,j as a,E as b,F as k,ah as F,u as P,r as j,ai as _,ax as $,o as v,d as L,h as N,Q as A,Y as D,bK as R,a3 as f}from"./index-Bzdyr4lv.js";import{B as V}from"./BotForm-DDJiLXaN.js";import{C as K}from"./CommonSettingsMenu-D0wShs5D.js";import{P as W,S as H,a as O}from"./SettingsContentContainer-Bb1q0MED.js";import{a as U}from"./validations-DJFqvO1k.js";import"./InstructionField-DvYKuhaq.js";import"./table-CFfrHzn6.js";import"./radio-cards-Dhb6fhh8.js";import"./useRavenSettings-CSKb1EiJ.js";import"./AINotEnabledCallout-D_hIx2-W.js";import"./CodeBlock-CbRDdjYQ.js";import"./index-C7yvjF9p.js";/* empty css                      */import"./FileSourceUploadDialog-DZoA9j1H.js";import"./TableLoader-DA7OuKyn.js";import"./Skeleton-DYPn3Qbq.js";import"./skeleton-qPsHtS8f.js";import"./tabs-CE6-Nr0L.js";import"./DeleteAlert-BvCIFTSZ.js";const I=e=>{const{ID:t}=B(),{data:o,isLoading:r,error:n,mutate:s}=E("Raven Bot",t);return a.jsxs(W,{children:[a.jsx(b,{error:n}),r&&a.jsx(k,{className:"h-64"}),o&&a.jsx(M,{data:o,mutate:s})]})},M=({data:e,mutate:t})=>{const{updateDoc:o,loading:r,error:n}=F(),s=P({disabled:r,defaultValues:e}),{formState:{dirtyFields:c}}=s,l=!U(c),d=m=>{o("Raven Bot",m.name,m).then(i=>{f.success("Saved"),s.reset(i),t(i,{revalidate:!1})})};return j.useEffect(()=>{const m=i=>{i.key==="s"&&(i.metaKey||i.ctrlKey)&&(i.preventDefault(),s.handleSubmit(d)())};return document.addEventListener("keydown",m),()=>document.removeEventListener("keydown",m)},[]),a.jsx("form",{onSubmit:s.handleSubmit(d),children:a.jsx(_,x(h({},s),{children:a.jsxs(H,{children:[a.jsx(O,{title:e.bot_name,headerBadges:l?[{label:"Not Saved",color:"red"}]:void 0,actions:a.jsxs($,{children:[a.jsx(K,{doctype:"Raven Bot",docname:e.name,label:"Agent"}),a.jsx(Q,{bot:e}),a.jsxs(v,{type:"submit",disabled:r,children:[r&&a.jsx(L,{className:"text-white"}),r?"Saving":"Save"]})]}),breadcrumbs:[{label:"Agents",href:"../"},{label:e.name,href:"",copyToClipboard:!0}]}),a.jsx(b,{error:n}),a.jsx(V,{isEdit:!0})]})}))})},Q=({bot:e})=>{const{call:t}=j.useContext(N),o=A(D),r=()=>{t.post("raven.api.raven_channel.create_direct_message_channel",{user_id:e.raven_user}).then(n=>{const s=o?`/${o}/${n.message}`:`/channel/${n.message}`;let c="raven";window.location.origin.endsWith("/")||(c="/"+c);const l=`${window.location.origin}${c}${s}`;window.open(l,"_blank")}).catch(n=>{f.error("Failed to create chat channel"),console.error(n)})};return a.jsxs(v,{variant:"surface",color:"gray",type:"button",className:"not-cal",onClick:r,children:["Open Chat",a.jsx(R,{})]})},pe=I;export{pe as Component};
