var q=Object.defineProperty,K=Object.defineProperties;var Q=Object.getOwnPropertyDescriptors;var N=Object.getOwnPropertySymbols;var E=Object.prototype.hasOwnProperty,T=Object.prototype.propertyIsEnumerable;var z=(s,a,n)=>a in s?q(s,a,{enumerable:!0,configurable:!0,writable:!0,value:n}):s[a]=n,R=(s,a)=>{for(var n in a||(a={}))E.call(a,n)&&z(s,n,a[n]);if(N)for(var n of N(a))T.call(a,n)&&z(s,n,a[n]);return s},_=(s,a)=>K(s,Q(a));var S=(s,a)=>{var n={};for(var t in s)E.call(s,t)&&a.indexOf(t)<0&&(n[t]=s[t]);if(s!=null&&N)for(var t of N(s))a.indexOf(t)<0&&T.call(s,t)&&(n[t]=s[t]);return n};import{b5 as Z,r as h,b6 as D,b7 as ee,e$ as se,cE as ae,co as ne,ck as re,b9 as L,f0 as te,j as e,n as ie,f1 as le,f2 as ce,aS as B,a as i,a4 as oe,f3 as de,p as v,a7 as he,aA as xe,aR as ue,az as me,bD as je,U as ge,V as pe,M as $,aj as W,x as H,i as y,b as fe,m as ye,be as ve,E as be,o as k,e as I,f4 as we,d as Ce,f5 as Ne,a3 as Ae}from"./index-BeJbNZtk.js";import{u as $e,P as ke,a as Ue}from"./usePagination-nkIiiDVT.js";import{m as Pe,d as Re,P as V,f,b as _e,R as Se,T as A}from"./table-CLczrdYh.js";import{T as ze}from"./TableLoader-DYMLczs5.js";import{u as Ee}from"./useDebounce-BUDBbsPR.js";import{r as M}from"./strong-DgHjcpwu.js";import"./Skeleton-DBIhUFTE.js";const Te=["1","2","3","4"],De=["none","initial"],Le=["left","center","right"],Be=_(R({},Z),{size:{type:"enum",className:"rt-r-size",values:Te,default:"4",responsive:!0},display:{type:"enum",className:"rt-r-display",values:De,parseValue:Ve,responsive:!0},align:{type:"enum",className:"rt-r-ai",values:Le,parseValue:We,responsive:!0}});function Ve(s){return s==="initial"?"flex":s}function We(s){return s==="left"?"start":s==="right"?"end":s}const Y=h.forwardRef((l,r)=>{var c=l,{width:s,minWidth:a,maxWidth:n,height:t,minHeight:u,maxHeight:x}=c,m=S(c,["width","minWidth","maxWidth","height","minHeight","maxHeight"]);const C=D(m,Be,se,ee),{asChild:o,children:b,className:U}=C,d=S(C,["asChild","children","className"]),{className:P,style:w}=D({width:s,minWidth:a,maxWidth:n,height:t,minHeight:u,maxHeight:x},ne,ae),j=o?re:"div";return h.createElement(j,_(R({},d),{ref:r,className:L("rt-Container",U)}),te({asChild:o,children:b},g=>h.createElement("div",{className:L("rt-ContainerInner",P),style:w},g)))});Y.displayName="Container";const He=({sortOrder:s,onSortOrderChange:a})=>{const n=()=>{a(s==="asc"?"desc":"asc")};return e.jsx(ie,{size:"1",color:"gray",variant:"soft",title:s==="asc"?"newest first":"oldest first",onClick:n,"aria-label":s==="asc"?"click to sort by newest first":"click to sort by oldest first",children:s==="asc"?e.jsx(le,{}):e.jsx(ce,{})})},Ie=({data:s,selected:a,setSelected:n,defaultSelected:t})=>{const u=r=>{n(r?l=>{const c=[];return s.forEach(o=>{!a.includes(o.name)&&!t.includes(o.name)&&c.push(o.name)}),[...l,...c]}:[])},x=h.useMemo(()=>{if(s&&s.length){let r=!0;return s==null||s.forEach(l=>{!a.includes(l.name)&&!t.includes(l.name)&&(r=!1)}),r}else return!1},[a,s]),m=r=>{n(l=>l.includes(r)?l.filter(c=>c!==r):[...l,r])};return e.jsxs(Pe,{variant:"surface",className:"rounded-sm",children:[e.jsx(Re,{children:e.jsxs(V,{children:[e.jsx(f,{children:e.jsx(B,{checked:x,onCheckedChange:r=>u(!!r.valueOf())})}),e.jsx(f,{children:"Name"}),e.jsx(f,{children:"User ID"}),e.jsx(f,{children:"Created on"}),e.jsx(f,{})]})}),e.jsx(_e,{children:s==null?void 0:s.map((r,l)=>{var o;const c=a.includes(r.name)||t.includes(r.name);return e.jsxs(V,{children:[e.jsx(Se,{children:e.jsx(B,{checked:c,disabled:t.includes(r.name),onCheckedChange:()=>m(r.name)})}),e.jsx(A,{children:e.jsxs(i,{gap:"2",align:"center",children:[e.jsx(oe,{src:r.user_image,alt:r.full_name}),(o=r.full_name)!=null?o:"-"]})}),e.jsx(A,{children:r.name}),e.jsx(A,{children:e.jsx(de,{date:r.creation})}),e.jsx(A,{children:r.role_profile_name?e.jsx(v,{children:e.jsx(he,{content:e.jsxs("span",{children:["A role profile has been assigned to this user.",e.jsx("br",{}),"If you want to add the user to Raven, please change their role profile."]}),children:e.jsxs(xe,{color:"red",variant:"solid",children:[e.jsx(ue,{size:"12"}),"Role Profile Added"]})})}):null})]},l)})})]})},Ze=()=>{const s=me();return e.jsx(Y,{children:e.jsx(i,{align:"center",justify:"center",className:"h-screen",children:s?e.jsx(Ye,{}):e.jsx(Me,{})})})},F="rounded-radius4",O="p-4 shadow-accent-a2 shadow-lg dark:shadow-accent-a2 dark:shadow-md",Me=()=>e.jsx(v,{className:$(F,"bg-accent-a4"),children:e.jsx(W,{className:$(O,"max-w-md"),children:e.jsxs(i,{direction:"column",align:"center",gap:"4",children:[e.jsx(v,{py:"1",children:e.jsx(i,{align:"center",justify:"center",className:"text-accent-11 bg-accent-a4 rounded-full p-4",children:e.jsx(Ne,{size:24})})}),e.jsxs(i,{direction:"column",align:"center",gap:"2",children:[e.jsxs(H,{as:"h2",className:"not-cal",size:"4",children:["You do not have access to ",e.jsx(y,{className:"cal-sans",children:"synk"}),"."]}),e.jsxs(y,{as:"p",size:"2",align:"center",className:"leading-6",children:["Please contact your Administrator or System Manager to give you the ",e.jsx(M,{children:'"Raven User"'})," role."]}),e.jsxs(i,{gap:"3",direction:"column",py:"1",pt:"3",children:[e.jsx(k,{asChild:!0,children:e.jsx(I,{className:"text-white",href:"/app/raven-user",children:"View Raven Users"})}),e.jsx(k,{variant:"outline",onClick:()=>window.location.reload(),children:"Refresh Page"})]})]})]})})}),Ye=()=>{const[s,a]=h.useState(""),n=Ee(s),t=p=>{a(p.target.value)},u=[["enabled","=",1],["name","not in",["Guest","Administrator"]],["user_type","!=","Website User"],["full_name","like",`%${n}%`]],{start:x,count:m,selectedPageLength:r,setPageLength:l,nextPage:c,previousPage:o}=$e("User",10,u),[b,U]=h.useState("desc"),{data:d,error:P}=je("User",{fields:["name","full_name","user_image","creation","enabled","user_type"],filters:u,orderBy:{field:"creation",order:b},limit_start:x>0?x-1:0,limit:r}),{currentUser:w}=h.useContext(ge),[j,C]=h.useState([]),{loading:g,call:G,error:J}=pe("raven.api.raven_users.add_users_to_raven"),X=()=>{G({users:JSON.stringify([...j,w])}).then(()=>{Ae.success(`You have added ${j.length} users to Raven`),window.location.reload()})};return e.jsx(v,{className:$(F,"bg-accent-a2"),children:e.jsxs(W,{className:$(O,"max-w-xl min-w-[720px]"),children:[e.jsxs(i,{gap:"2",direction:"column",children:[e.jsx(H,{as:"h1",children:"Add users to synk"}),e.jsxs(y,{as:"p",size:"2",className:"leading-6",children:["Users you add will be given the ",e.jsx(M,{children:'"Raven User"'})," role."]})]}),e.jsxs(i,{direction:"column",gap:"4",pt:"4",className:"max-h-[80vh]",children:[e.jsxs(i,{justify:"between",gap:"2",children:[e.jsxs(i,{gap:"2",align:"center",children:[e.jsx(fe,{style:{width:"320px"},onChange:t,value:s,type:"text",placeholder:"Search for user",children:e.jsx(ye,{side:"left",children:e.jsx(ve,{})})}),n.length>0&&n.length<2&&e.jsx(y,{size:"1",color:"gray",children:"Continue typing..."})]}),e.jsxs(i,{justify:"end",gap:"2",align:"center",children:[e.jsx(He,{sortOrder:b,onSortOrderChange:p=>U(p)}),e.jsx(ke,{options:[10,20,50,100],selectedValue:r,updateValue:p=>l(p)}),e.jsx(Ue,{rowsPerPage:r,start:x,totalRows:m,gotoNextPage:()=>c(),gotoPreviousPage:()=>o()})]})]}),!d&&!P&&e.jsx(ze,{columns:3}),d&&d.length===0&&n.length>=2&&e.jsx(i,{align:"center",justify:"center",className:"min-h-[32rem]",children:e.jsx(y,{size:"2",align:"center",children:"No results found"})}),d&&d.length!==0&&e.jsx(Ie,{data:d,defaultSelected:[w],selected:j,setSelected:C})]}),e.jsxs(v,{pt:"3",children:[e.jsx(be,{error:J}),e.jsxs(i,{align:"center",gap:"2",justify:"between",pt:"3",children:[e.jsx(i,{align:"center",gap:"2",children:e.jsx(k,{color:"gray",variant:"soft",asChild:!0,children:e.jsxs(I,{href:"/app",className:"flex items-center",children:[e.jsx(we,{size:"20"}),"Go back to Desk"]})})}),e.jsxs(k,{type:"button",disabled:g,onClick:X,children:[g&&e.jsx(Ce,{}),g?"Adding":"Add to Raven"]})]})]})]})})};export{Ze as default};
