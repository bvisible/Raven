const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/AddMembersDropdown-DD2JyqtK.js","assets/index-Bzdyr4lv.js","assets/index-DjJuykjq.css","assets/MultipleUserCombobox-BisEvXh3.js","assets/WorkspaceMemberManagement-DEZ1kMyX.js","assets/index-BPGqraCR.js","assets/table-CFfrHzn6.js","assets/TableLoader-DA7OuKyn.js","assets/Skeleton-DYPn3Qbq.js","assets/useGetUserRecords-CJtRHnM9.js","assets/hover-card-DQMnXiEU.js","assets/useCurrentChannelData-CW_OYP7x.js","assets/index-C7yvjF9p.js","assets/useRavenSettings-CSKb1EiJ.js","assets/preferences-9RVrxeBb.js","assets/DoctypeLinkRenderer-nUJ04IkZ.js","assets/useDoctypeMeta-C5c8XNZN.js","assets/skeleton-qPsHtS8f.js","assets/useDebounce-CUxDZSjG.js","assets/useCurrentChannelData-BsL46_d-.css"])))=>i.map(i=>d[i]);
var X=Object.defineProperty,D=Object.defineProperties;var ss=Object.getOwnPropertyDescriptors;var v=Object.getOwnPropertySymbols;var S=Object.prototype.hasOwnProperty,N=Object.prototype.propertyIsEnumerable;var z=(e,i,r)=>i in e?X(e,i,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[i]=r,_=(e,i)=>{for(var r in i||(i={}))S.call(i,r)&&z(e,r,i[r]);if(v)for(var r of v(i))N.call(i,r)&&z(e,r,i[r]);return e},y=(e,i)=>D(e,ss(i));var A=(e,i)=>{var r={};for(var n in e)S.call(e,n)&&i.indexOf(n)<0&&(r[n]=e[n]);if(e!=null&&v)for(var n of v(e))i.indexOf(n)<0&&N.call(e,n)&&(r[n]=e[n]);return r};import{u as B,ah as es,j as s,ai as O,au as T,_ as t,a as c,E as P,p as w,L as rs,bu as is,i as l,c as I,ay as L,o as x,d as C,a3 as $,r as h,P as R,a6 as V,a8 as Y,aa as G,ab as ns,d_ as H,d$ as Q,e0 as W,bx as ts,bd as os,V as ds,bo as Z,av as cs,aP as ls,aI as as,M,v as ms,eP as us,U as q,dn as xs,e2 as hs,eQ as E,a4 as ps,x as J,aA as js,cZ as gs,e as bs}from"./index-Bzdyr4lv.js";import{u as K}from"./useCurrentChannelData-CW_OYP7x.js";import{u as _s}from"./useGetUserRecords-CJtRHnM9.js";const F=({channelData:e,onClose:i})=>{var b;const r=B({defaultValues:{channel_description:e==null?void 0:e.channel_description}}),{register:n,handleSubmit:o,formState:{errors:d}}=r,{updateDoc:a,loading:m,error:j}=es(),g=p=>{var u;a("Raven Channel",(u=e==null?void 0:e.name)!=null?u:null,{channel_description:p.channel_description}).then(()=>{$.success(t("Channel description updated")),i()})};return s.jsx(O,y(_({},r),{children:s.jsxs("form",{onSubmit:o(g),children:[s.jsx(T,{children:e&&(e!=null&&e.channel_description)&&(e==null?void 0:e.channel_description.length)>0?t("Edit description"):t("Add description")}),s.jsxs(c,{gap:"2",direction:"column",width:"100%",children:[s.jsx(P,{error:j}),s.jsxs(w,{width:"100%",children:[s.jsx(rs,{htmlFor:"channel_description",children:t("Channel description")}),s.jsx(is,y(_({id:"channel_description",placeholder:t("Add description")},n("channel_description")),{"aria-invalid":d.channel_description?"true":"false"})),s.jsx(l,{size:"1",weight:"light",children:t("This is how people will know what this channel is about.")}),(d==null?void 0:d.channel_description)&&s.jsx(I,{children:(b=d.channel_description)==null?void 0:b.message})]})]}),s.jsxs(c,{gap:"3",mt:"6",justify:"end",align:"center",children:[s.jsx(L,{disabled:m,children:s.jsx(x,{variant:"soft",color:"gray",children:t("Cancel")})}),s.jsxs(x,{type:"submit",disabled:m,children:[m&&s.jsx(C,{className:"text-white"}),m?t("Saving"):t("Save")]})]})]})}))},ys=({channelData:e,is_in_box:i})=>{const[r,n]=h.useState(!1),o=()=>{n(!1)},d=e&&e.channel_description&&e.channel_description.length>0?"Edit":"Add";return R()?s.jsxs(V,{open:r,onOpenChange:n,children:[s.jsx(Y,{children:s.jsxs(x,{variant:"ghost",size:"1",children:[d," ",i?"":"description"]})}),s.jsx(G,{className:ns,children:s.jsx(F,{channelData:e,onClose:o})})]}):s.jsxs(H,{open:r,onOpenChange:n,children:[s.jsx(Q,{asChild:!0,children:s.jsxs(x,{variant:"ghost",size:"1",children:[d," ",i?"":"description"]})}),s.jsx(W,{children:s.jsx("div",{className:"pb-16 min-h-48 px-1 overflow-auto",children:s.jsx(F,{channelData:e,onClose:o})})})]})},fs=h.lazy(()=>as(()=>import("./AddMembersDropdown-DD2JyqtK.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19]))),U=({onClose:e})=>{var p;const{channelID:i}=ts(),{channel:r}=K(i!=null?i:""),{mutate:n}=os(),{call:o,error:d,loading:a}=ds("raven.api.raven_channel_member.add_channel_members"),m=B({defaultValues:{add_members:null}}),{handleSubmit:j,control:g}=m,b=u=>{u.add_members&&u.add_members.length>0&&o({channel_id:i,members:u.add_members.map(f=>f.name)}).then(()=>{$.success("Members added"),n(["channel_members",i]),e()})};return s.jsx(s.Fragment,{children:i&&r&&s.jsx(O,y(_({},m),{children:s.jsxs("form",{onSubmit:j(b),children:[s.jsx(T,{children:s.jsxs(l,{as:"span",children:["Add members to ",s.jsx(Z,{type:r==null?void 0:r.channelData.type,size:"18",className:"inline-block -mb-0.5"}),r==null?void 0:r.channelData.channel_name]})}),s.jsxs(cs,{size:"2",children:["New members will be able to see all of ",s.jsx("strong",{children:r==null?void 0:r.channelData.channel_name}),"'s history, including any files that have been shared in the channel."]}),s.jsxs(c,{gap:"2",pt:"2",direction:"column",width:"100%",children:[s.jsx(P,{error:d}),s.jsx(l,{size:"2",children:"You can only add members from your workspace to this channel."}),s.jsx(w,{width:"100%",children:s.jsx(c,{direction:"column",gap:"2",children:s.jsxs(c,{direction:"column",gap:"2",children:[s.jsx(h.Suspense,{fallback:s.jsx(C,{}),children:s.jsx(ls,{control:g,name:"add_members",rules:{validate:u=>u&&u.length>0?!0:"Please select at least one member"},render:({field:{onChange:u,value:f}})=>{var k;return s.jsx(fs,{setSelectedUsers:u,workspaceID:(k=r==null?void 0:r.channelData.workspace)!=null?k:"",selectedUsers:f!=null?f:[],channelID:i,label:""})}})}),s.jsx(I,{children:(p=m.formState.errors.add_members)==null?void 0:p.message})]})})})]}),s.jsxs(c,{gap:"3",mt:"6",justify:"end",align:"center",children:[s.jsx(L,{disabled:a,children:s.jsx(x,{variant:"soft",color:"gray",children:"Cancel"})}),s.jsxs(x,{type:"submit",disabled:a,children:[a&&s.jsx(C,{className:"text-white"}),a?"Saving":"Save"]})]})]})}))})},vs=r=>{var n=r,{channelData:e}=n,i=A(n,["channelData"]);const[o,d]=h.useState(!1),a=()=>{d(!1)};return R()?s.jsxs(V,{open:o,onOpenChange:d,children:[s.jsx(Y,{children:s.jsx(x,y(_({variant:"ghost",size:"1"},i),{className:M("text-nowrap",i.className),children:"Add Members"}))}),s.jsx(G,{className:"static",children:s.jsx(U,{onClose:a})})]}):s.jsxs(H,{open:o,onOpenChange:d,children:[s.jsx(Q,{asChild:!0,children:s.jsx(x,y(_({variant:"ghost",size:"1"},i),{className:M("text-nowrap",i.className),children:"Add Members"}))}),s.jsx(W,{children:s.jsx("div",{className:"pb-16 min-h-96 px-1 overflow-auto",children:s.jsx(U,{onClose:a})})})]})},ws=e=>{var d;const{data:i,error:r,isLoading:n,mutate:o}=ms("raven.api.chat.get_channel_members",{channel_id:e},["channel_members",e],{keepPreviousData:!0,dedupingInterval:3e5});return{channelMembers:(d=i==null?void 0:i.message)!=null?d:{},error:r,isLoading:n,mutate:o}},Ms=()=>s.jsx(c,{justify:"center",align:"center",className:"w-full h-64",children:s.jsxs(c,{direction:"column",gap:"1",className:"text-center",children:[s.jsx(l,{weight:"bold",size:"5",children:t("Nothing turned up")}),s.jsx(l,{as:"span",size:"2",children:t("You may want to try using different keywords, checking for typos or adjusting your filters.")}),s.jsxs(l,{as:"span",size:"2",children:[t("Not the results that you expected? File an issue on")," ",s.jsx(bs,{href:"https://github.com/The-Commit-Company/Raven",target:"_blank",rel:"noreferrer",children:s.jsx(l,{color:"blue",size:"2",children:"GitHub"})}),"."]})]})}),Cs=({channelData:e})=>{var a;const{channelMembers:i}=ws(e.name),{currentUser:r}=h.useContext(q),n=_s(),o=s.jsx(gs,{date:e==null?void 0:e.creation}),{isAdmin:d}=h.useMemo(()=>{const m=i[r];return{isAdmin:(m==null?void 0:m.is_admin)==1}},[i,r]);return s.jsxs(c,{direction:"column",className:"p-2",gap:"2",children:[s.jsxs(c,{direction:"column",gap:"2",children:[s.jsxs(c,{align:"center",gap:"1",children:[s.jsx(Z,{type:e==null?void 0:e.type}),s.jsx(J,{size:"4",children:e==null?void 0:e.channel_name})]}),s.jsxs(l,{size:"2",children:[(a=n[e.owner])==null?void 0:a.full_name," ",t("created this channel on")," ",o,". ",t("This is the very beginning of the")," ",s.jsx("strong",{children:e==null?void 0:e.channel_name})," ",t("channel.")]}),(e==null?void 0:e.channel_description)&&s.jsx(l,{size:"1",color:"gray",children:e==null?void 0:e.channel_description})]}),(e==null?void 0:e.is_archived)==0&&d&&s.jsxs(c,{gap:"4",className:"z-1",children:[s.jsx(ys,{channelData:e}),(e==null?void 0:e.type)!=="Open"&&s.jsx(vs,{channelData:e})]})]})},ks=({channelData:e})=>{var g;const{currentUser:i}=h.useContext(q),r=e.peer_user_id,n=xs(r),{fullName:o,userImage:d,isBot:a}=h.useMemo(()=>{var p,u;const b=(n==null?void 0:n.type)==="Bot";return{fullName:(p=n==null?void 0:n.full_name)!=null?p:r,userImage:(u=n==null?void 0:n.user_image)!=null?u:"",isBot:b}},[n,r]),m=hs(r),j=(g=o!=null?o:r)!=null?g:E(e.channel_name,i);return s.jsx(w,{className:"p-2",children:(e==null?void 0:e.is_direct_message)==1&&s.jsxs(c,{direction:"column",gap:"3",children:[s.jsxs(c,{gap:"3",align:"center",children:[s.jsx(ps,{alt:j,src:d,size:"3",skeletonSize:"7",isBot:a,availabilityStatus:n==null?void 0:n.availability_status,isActive:m}),s.jsxs(c,{direction:"column",gap:"0",children:[s.jsx(J,{size:"4",children:j}),s.jsx("div",{children:a?s.jsx(js,{color:"gray",className:"py-0 px-1",children:t("Bot")}):s.jsx(l,{size:"1",color:"gray",children:r})})]})]}),(e==null?void 0:e.is_self_message)==1?s.jsxs(c,{direction:"column",gap:"0",children:[s.jsxs(l,{size:"2",children:[s.jsx("strong",{children:t("This space is all yours.")})," ",t("Draft messages, list your to-dos, or keep links and files handy.")," "]}),s.jsx(l,{size:"2",children:t("And if you ever feel like talking to yourself, don't worry, we won't judge - just remember to bring your own banter to the table.")})]}):s.jsx(c,{gap:"2",align:"center",children:r||o?s.jsxs(l,{size:"2",children:[t("This is a Direct Message channel between you and")," ",s.jsx("strong",{children:o!=null?o:r}),"."]}):s.jsxs(l,{size:"2",children:[t("We could not find the user for this DM channel")," (",E(e.channel_name,i),")."]})})]})})},Es=()=>s.jsx(w,{className:"py-2 px-6",children:s.jsxs(c,{direction:"column",gap:"2",children:[s.jsx(l,{size:"3",children:s.jsx("strong",{children:t("Your saved messages will appear here")})}),s.jsxs(c,{direction:"column",gap:"1",children:[s.jsx(l,{size:"2",as:"span",children:t("Saved messages are a convenient way to keep track of important information or messages you want to refer back to later.")}),s.jsxs(l,{size:"2",as:"span",children:[t("You can save messages by simply clicking on the bookmark icon")," ",s.jsx(us,{className:"-mb-0.5"})," ",t("in message actions.")]})]})]})}),Fs=({channelID:e})=>{const{channel:i}=K(e);return i?i.type==="dm"?s.jsx(ks,{channelData:i.channelData}):s.jsx(Cs,{channelData:i.channelData}):null};export{U as A,Fs as C,Es as E,Ms as a,ys as b,vs as c,ws as u};
