var Z=Object.defineProperty,P=Object.defineProperties;var aa=Object.getOwnPropertyDescriptors;var _=Object.getOwnPropertySymbols;var T=Object.prototype.hasOwnProperty,V=Object.prototype.propertyIsEnumerable;var y=(s,t,e)=>t in s?Z(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e,v=(s,t)=>{for(var e in t||(t={}))T.call(t,e)&&y(s,e,t[e]);if(_)for(var e of _(t))V.call(t,e)&&y(s,e,t[e]);return s},S=(s,t)=>P(s,aa(t));var q=(s,t)=>{var e={};for(var r in s)T.call(s,r)&&t.indexOf(r)<0&&(e[r]=s[r]);if(s!=null&&_)for(var r of _(s))t.indexOf(r)<0&&V.call(s,r)&&(e[r]=s[r]);return e};import{V as J,$ as f,j as a,a0 as sa,_ as l,a as c,E as K,i as $,a1 as ea,o as D,a2 as ta,d as Q,a3 as g,r as N,p as W,a4 as na,a5 as la,a6 as ra,a7 as X,a8 as ia,n as A,a9 as ca,aa as oa,ab as Y,ac as ua,ad as da,ae as ma,af as ga,ag as ha,u as ja,ah as xa,P as pa,ai as ba,aj as _a,L as O,S as va,b as B,c as G,O as H,ak as Sa,al as Na,am as d,an as fa,ao as m,ap as wa,m as Ia,aq as Ca,ar as ka,as as Ua,at as Oa}from"./index-Y1VVLmGB.js";import{U as $a}from"./UploadImageModal-CnWX5WG2.js";import Da from"./EmojiPicker-CriLUiO4.js";import{P as Aa,S as Fa,a as Ra}from"./SettingsContentContainer-4p3VU33_.js";import"./AddCustomEmojiDialog-CXqDAMVy.js";const Ea=({onClose:s})=>{const{call:t,loading:e,error:r}=J("raven.api.raven_users.update_raven_user"),{mutate:h}=f(),i=()=>{t({user_image:""}).then(()=>{g.success("Profile picture removed."),h(),s()})};return a.jsxs(a.Fragment,{children:[a.jsx(sa,{children:l("Remove Image")}),a.jsxs(c,{direction:"column",gap:"2",children:[a.jsx(K,{error:r}),a.jsx($,{children:l("Are you sure you want to remove this image?")})]}),a.jsxs(c,{gap:"3",mt:"4",justify:"end",children:[a.jsx(ea,{children:a.jsx(D,{variant:"soft",color:"gray",children:l("Cancel")})}),a.jsx(ta,{children:a.jsxs(D,{variant:"solid",color:"red",onClick:i,disabled:e,children:[e&&a.jsx(Q,{}),e?l("Removing"):l("Remove")]})})]})]})},za=h=>{var i=h,{icon:s,accept:t={"image/*":[".jpeg",".jpg",".png"]},maxFileSize:e}=i,r=q(i,["icon","accept","maxFileSize"]);var j;const{call:w}=J("raven.api.raven_users.update_raven_user"),{myProfile:n,mutate:I}=f(),[u,o]=N.useState(!1),[C,k]=N.useState(!1),U=x=>{x&&w({user_image:x}).then(()=>{g(l("Image uploaded successfully.")),I(),o(!1)}).catch(p=>{g("There was an error while uploading the image.",{description:ua(p)})})};return a.jsx(c,{direction:"column",gap:"3",children:a.jsxs(W,{className:"relative",children:[n!=null&&n.user_image?a.jsx("img",{src:n==null?void 0:n.user_image,alt:"User Image",className:"object-cover h-44 w-44 rounded-xl"}):a.jsx(na,{alt:n==null?void 0:n.full_name,size:"9",fallback:la(n==null?void 0:n.full_name),className:"h-44 w-44"}),a.jsx(La,{open:u,setOpen:o,uploadImage:U,userID:(j=n==null?void 0:n.name)!=null?j:""}),(n==null?void 0:n.user_image)&&a.jsx(Ma,{open:C,setOpen:k})]})})},La=({open:s,setOpen:t,uploadImage:e,userID:r})=>a.jsxs(ra,{open:s,onOpenChange:t,children:[a.jsx(X,{content:"Upload Image",side:"right",children:a.jsx(ia,{children:a.jsx(A,{type:"button","aria-label":"upload image",size:"1",className:"absolute -right-2 -bottom-1 rounded-md shadow-md",children:a.jsx(ca,{size:"12"})})})}),a.jsx(oa,{className:Y,children:a.jsx($a,{isPrivate:!1,uploadImage:e,doctype:"Raven User",docname:r,fieldname:"user_image"})})]}),Ma=({open:s,setOpen:t})=>{const e=()=>{t(!1)};return a.jsxs(da,{open:s,onOpenChange:t,children:[a.jsx(X,{content:"Remove Image",side:"right",children:a.jsx(ma,{children:a.jsx(A,{type:"button","aria-label":"remove image",size:"1",className:"absolute -right-2 bottom-6 rounded-md bg-white dark:bg-slate-4 shadow-md",children:a.jsx(ga,{size:"12",color:"tomato"})})})}),a.jsx(ha,{className:Y,children:a.jsx(Ea,{onClose:e})})]})},ya=()=>{const{myProfile:s}=f();return s?a.jsx(Ta,{myProfile:s}):null},Ta=({myProfile:s})=>{var p,F,R,E,z,L;const{mutate:t}=f(),e=ja({defaultValues:{full_name:(p=s==null?void 0:s.full_name)!=null?p:"",user_image:(F=s==null?void 0:s.user_image)!=null?F:"",availability_status:(R=s==null?void 0:s.availability_status)!=null?R:"",custom_status:(E=s==null?void 0:s.custom_status)!=null?E:""}}),{register:r,handleSubmit:h,formState:{errors:i}}=e,{updateDoc:w,loading:n,error:I}=xa(),[u,o]=N.useState((z=s==null?void 0:s.availability_status)!=null?z:""),C=b=>{var M;w("Raven User",(M=s==null?void 0:s.name)!=null?M:null,{full_name:b.full_name,availability_status:u,custom_status:b.custom_status}).then(()=>{g.success(l("Profile updated")),t()}).catch(()=>{g.error(l("Profile update failed"))})},[k,U]=N.useState(!1),j=b=>{e.setValue("custom_status",`${e.getValues("custom_status")} ${b}`)},x=pa();return a.jsx(Aa,{children:a.jsx(ba,S(v({},e),{children:a.jsx("form",{onSubmit:h(C),children:a.jsxs(Fa,{children:[a.jsx(Ra,{title:l("Profile"),description:l("Manage your Raven profile"),actions:a.jsxs(D,{type:"submit",disabled:n,children:[n&&a.jsx(Q,{}),n?l("Saving"):l("Save")]})}),a.jsx(_a,{className:"p-0 align-middle justify-center",children:a.jsxs(c,{direction:"column",gap:"0",children:[a.jsx(W,{className:"flex justify-center items-center bg-slate-2 dark:bg-slate-3 py-6",children:a.jsx(za,{})}),a.jsx(K,{error:I}),a.jsxs(c,{gap:"4",direction:"column",className:"py-4 px-6 dark:bg-slate-2",children:[a.jsxs(c,{justify:"between",align:"center",children:[a.jsx(O,{htmlFor:"full_name",isRequired:!0,children:l("Full Name")}),a.jsxs(va,{gap:"1",children:[a.jsx(B,S(v({autoFocus:!0,maxLength:140,className:"w-48 sm:w-96",id:"full_name",placeholder:"Full Name"},r("full_name",{maxLength:{value:140,message:l("Name cannot be more than {0} characters.",[140])},required:l("Name is required")})),{"aria-invalid":i.full_name?"true":"false"})),(i==null?void 0:i.full_name)&&a.jsx(G,{children:(L=i.full_name)==null?void 0:L.message})]})]}),a.jsx(H,{className:"w-full bg-slate-4"}),a.jsxs(c,{justify:"between",align:"center",children:[a.jsx(O,{htmlFor:"availability_status",children:l("Availability Status")}),a.jsxs(Sa,{children:[a.jsx(Na,{children:a.jsx(c,{gap:"2",align:"center",className:"text-sm px-2 py-1 border border-gray-7 rounded w-48 sm:w-96",children:u?d(u):a.jsx($,{color:"gray",children:l("Set Availability")})})}),a.jsxs(fa,{variant:"soft",children:[a.jsx(m,{className:"flex justify-normal gap-2",color:"gray",onClick:()=>o("Available"),children:d("Available")}),a.jsx(m,{className:"flex justify-normal gap-2",color:"gray",onClick:()=>o("Away"),children:d("Away")}),a.jsx(m,{className:"flex justify-normal gap-2",color:"gray",onClick:()=>o("Do not disturb"),children:d("Do not disturb")}),a.jsx(m,{className:"flex justify-normal gap-2",color:"gray",onClick:()=>o("Invisible"),children:d("Invisible")}),a.jsxs(m,{className:"flex justify-normal gap-2",color:"gray",onClick:()=>o(""),children:[a.jsx(wa,{fontSize:"0.7rem"})," ",l("Reset")]})]})]})]}),a.jsx(H,{className:"w-full bg-slate-4"}),a.jsxs(c,{justify:"between",align:"center",children:[a.jsxs(c,{direction:"column",gap:"0",children:[a.jsx(O,{htmlFor:"custom_status",children:l("Custom Status")}),x&&a.jsx($,{size:"1",color:"gray",style:{lineHeight:"0.8"},children:l("Share what you are up to")})]}),a.jsx(c,{align:"center",gap:"3",children:a.jsxs(c,{direction:"column",gap:"1",children:[a.jsx(B,S(v({id:"custom_status",placeholder:"e.g. Out of Office",maxLength:140},r("custom_status",{maxLength:{value:140,message:l("Status cannot be more than {} characters.",["140"])}})),{className:"w-48 sm:w-96","aria-invalid":i.custom_status?"true":"false",children:a.jsx(Ia,{side:"right",children:a.jsxs(Ca,{children:[a.jsx(ka,{children:a.jsx(A,{type:"button",className:"rounded-full",onClick:()=>U(!k),variant:"ghost",color:"gray",children:a.jsx(Ua,{size:"18"})})}),a.jsx(Oa,{className:"p-0",children:a.jsx(Da,{onSelect:j})})]})})})),i.custom_status&&a.jsx(G,{children:i.custom_status.message})]})})]})]})]})})]})})}))})},Ka=ya;export{Ka as Component};
