import{G as J,a3 as Z,P as b,j as e,dY as o,p as v,ak as T,al as k,i as j,fh as q,a,a4 as H,f3 as K,cZ as Q,an as X,ao as f,dI as B,dJ as A,cu as M,a7 as _,o as w,r as D,bx as ee,v as F,au as se,ay as re,n as ae,b as ne,m as C,be as ie,d as te,aD as le,aE as ce,aF as oe,c6 as xe,c7 as de,aG as h,E as L,x as he}from"./index-3Ycoded3.js";import{u as pe}from"./useDebounce-CGP5u_EX.js";import{b as je,P as me,a as ge}from"./usePagination-ByI4sTOZ.js";import{T as ue}from"./TableLoader-BVWP7Tbp.js";import{m as ye,d as fe,P as S,f as l,b as _e,T as c}from"./table-DrC99LcT.js";import{p as we,s as ve,C as be}from"./hover-card-DvDR9bGa.js";import{e as ze}from"./TypingIndicator-Cct4CTRl.js";import"./Skeleton-D01F4Rww.js";import"./index-DkXGvIGh.js";import"./useCurrentChannelData-DZI4XeEa.js";import"./useGetUserRecords-C-fgbSkZ.js";import"./useRavenSettings-CtoBUiVb.js";import"./preferences-BO9HcdBT.js";import"./DoctypeLinkRenderer-Bg3Oat9l.js";import"./useDoctypeMeta-DEGru9VW.js";import"./skeleton-BCqI9NmJ.js";/* empty css                      */import"./EmptyState-BZIecBWB.js";import"./DateSeparator-D8GG3Auz.js";import"./tabs-DXfZPLYu.js";function Ne(r){return J({attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M405 136.798L375.202 107 256 226.202 136.798 107 107 136.798 226.202 256 107 375.202 136.798 405 256 285.798 375.202 405 405 375.202 285.798 256z"},child:[]}]})(r)}const O=r=>()=>{r.startsWith("http")||r.startsWith("https")?navigator.clipboard.writeText(r):navigator.clipboard.writeText(window.location.origin+r),Z.success("Link copied")},Pe=({data:r})=>b()?e.jsxs(ye,{variant:"surface",className:"overflow-scroll",children:[e.jsx(fe,{children:e.jsxs(S,{children:[e.jsx(l,{children:"Preview"}),e.jsx(l,{children:"Name"}),e.jsx(l,{children:"Type"}),e.jsx(l,{children:"Size"}),e.jsx(l,{children:"Sent by"}),e.jsx(l,{children:"Shared on"}),e.jsx(l,{children:"Actions"})]})}),e.jsx(_e,{children:r==null?void 0:r.map((s,p)=>{var i,n,m;return e.jsxs(S,{children:[e.jsx(c,{children:s.message_type==="File"?e.jsx(o,{ext:(n=(i=s.file_type)==null?void 0:i.toLowerCase())!=null?n:"file",style:{paddingLeft:"4"}}):e.jsx($,{file:s})}),e.jsx(c,{children:e.jsx(v,{className:"relative",style:{cursor:"pointer",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(j,{children:s.file_name})}),e.jsx(I,{file:s.file_url})]})})}),e.jsx(c,{children:s.file_type?s.file_type:"File"}),e.jsx(c,{children:q(s.file_size)}),e.jsx(c,{children:e.jsxs(a,{gap:"2",align:"center",children:[e.jsx(H,{src:s.user_image,alt:s.full_name}),(m=s.full_name)!=null?m:"-"]})}),e.jsx(c,{children:e.jsx(K,{date:s.creation})}),e.jsx(c,{children:e.jsx(E,{file:s.file_url})})]},s.name)})})]}):e.jsx(a,{direction:"column",gap:"3",className:"overflow-scroll pb-4",children:r==null?void 0:r.map(s=>{var p,i,n;return e.jsxs(a,{align:"center",justify:"between",className:"border-b border-gray-4 dark:border-gray-6`} pb-3",children:[e.jsx(a,{direction:"column",children:e.jsxs(a,{gap:"2",align:"center",children:[e.jsx(a,{className:"w-8 items-center justify-center",children:s.message_type==="File"?e.jsx(o,{ext:(i=(p=s.file_type)==null?void 0:p.toLowerCase())!=null?i:"file",className:"px-2"}):e.jsx($,{file:s})}),e.jsxs(v,{className:"relative",style:{cursor:"pointer",maxWidth:"250px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"},children:[e.jsxs(T,{children:[e.jsx(k,{children:e.jsx(j,{size:"2",as:"span",className:"text-ellipsis",children:s.file_name})}),e.jsx(I,{file:s.file_url})]}),e.jsx(a,{gap:"2",align:"center",children:e.jsxs(j,{size:"1",color:"gray",children:["by ",(n=s.full_name)!=null?n:s.owner," on ",e.jsx(Q,{date:s.creation})]})})]})]})}),e.jsx(E,{file:s.file_url})]},s.name)})}),$=({file:r})=>e.jsxs(we,{children:[e.jsx(ve,{children:e.jsx("img",{style:{borderRadius:"4px"},src:r.file_url,alt:r.file_name,className:"object-cover w-8 h-8 sm:w-[25px] sm:h-[25px]"})}),e.jsx(be,{children:e.jsx(ze,{side:"all",mb:"0",className:"-mb-6",children:e.jsx("img",{src:r.file_thumbnail||r.file_url,alt:r.file_name,height:r.thumbnail_height||"200px",width:r.thumbnail_width||"200px",className:"object-cover"})})})]}),E=({file:r})=>{const t=O(r),s=b();return e.jsxs(a,{gap:"2",children:[e.jsx(_,{content:"Copy link",children:e.jsx(w,{variant:"soft",color:"gray",size:"1",onClick:t,children:e.jsx(B,{size:"16"})})}),e.jsx(_,{content:"Download",children:e.jsx("a",{download:!0,href:r,children:e.jsx(w,{variant:"soft",color:"gray",size:"1",children:e.jsx(A,{size:"16"})})})}),s&&e.jsx(_,{content:"Open in new tab",children:e.jsx("a",{href:r,target:"_blank",rel:"noreferrer",children:e.jsx(w,{variant:"soft",color:"gray",size:"1",children:e.jsx(M,{size:"14"})})})})]})},I=({file:r})=>{const t=O(r);return e.jsxs(X,{children:[e.jsx(f,{onClick:t,children:e.jsxs(a,{gap:"2",children:[e.jsx(B,{size:"18"}),"Copy link"]})}),e.jsx(f,{children:e.jsx("a",{download:!0,href:r,children:e.jsxs(a,{gap:"2",children:[e.jsx(A,{size:"18"}),"Download"]})})}),e.jsx(f,{children:e.jsx("a",{href:r,target:"_blank",rel:"noreferrer",children:e.jsxs(a,{gap:"2",children:[e.jsx(M,{size:"16"}),"Open in new tab"]})})})]})},Je=()=>{var N,P;const[r,t]=D.useState(""),s=pe(r,200),p=y=>{t(y.target.value)},{channelID:i}=ee(),[n,m]=D.useState(),{data:x,error:R}=F("raven.api.raven_message.get_count_for_pagination_of_files",{channel_id:i,file_name:s,file_type:n==="any"?void 0:n}),{start:g,selectedPageLength:u,setPageLength:V,nextPage:W,previousPage:G}=je(10,(N=x==null?void 0:x.message)!=null?N:0),{data:d,error:z,isLoading:U}=F("raven.api.raven_message.get_all_files_shared_in_channel",{channel_id:i,file_name:s,file_type:n==="any"?void 0:n,start_after:g>0?g-1:0,page_length:u}),Y=b();return e.jsxs("div",{children:[e.jsxs(a,{justify:"between",gap:"2",children:[e.jsx(se,{children:"Files shared in this channel"}),Y&&e.jsx(re,{children:e.jsx(ae,{size:"1",color:"gray",variant:"soft","aria-label":"close dialog",children:e.jsx(Ne,{})})})]}),e.jsxs(a,{direction:"column",gap:"4",className:"pt-0 sm:pt-4 h-[80vh] sm:max-h-[75vh] sm:min-h-[75vh]",children:[e.jsxs(a,{justify:"between",gap:"2",className:"flex-col sm:flex-row",children:[e.jsxs(a,{gap:"2",className:"flex-col sm:flex-row sm:items-center",children:[e.jsxs(ne,{className:"w-full sm:w-[400px]",onChange:p,type:"text",placeholder:"Search for file",autoFocus:!0,children:[e.jsx(C,{side:"left",children:e.jsx(ie,{})}),e.jsx(C,{side:"right",children:U&&e.jsx(te,{})})]}),e.jsxs(le,{value:n,onValueChange:m,children:[e.jsx(ce,{placeholder:"File Type",className:"w-full sm:w-[200px]"}),e.jsx(oe,{className:"z-50",children:e.jsxs(xe,{children:[e.jsx(de,{children:"File Type"}),e.jsx(h,{value:"any",children:e.jsxs(a,{align:"center",gap:"1",children:[e.jsx(v,{width:"16px",children:"ðŸ¤·ðŸ»â€â™€ï¸"}),"Any"]})}),e.jsx(h,{value:"pdf",children:e.jsxs(a,{gap:"2",children:[e.jsx(o,{ext:"pdf",size:"14",style:{paddingTop:2}}),"PDF"]})}),e.jsx(h,{value:"doc",children:e.jsxs(a,{gap:"2",children:[e.jsx(o,{ext:"doc",size:"14",style:{paddingTop:2}}),"Documents (.doc)"]})}),e.jsx(h,{value:"ppt",children:e.jsxs(a,{gap:"2",children:[e.jsx(o,{ext:"ppt",size:"14",style:{paddingTop:2}}),"Presentations (.ppt)"]})}),e.jsx(h,{value:"xls",children:e.jsxs(a,{gap:"2",children:[e.jsx(o,{ext:"xls",size:"14",style:{paddingTop:2}}),"Spreadsheets (.xls)"]})}),e.jsx(h,{value:"image",children:e.jsxs(a,{gap:"2",children:[e.jsx(o,{ext:"jpg",size:"14",style:{paddingTop:2}}),"Images"]})})]})})]}),s.length>0&&s.length<2&&e.jsx(j,{size:"1",color:"gray",children:"Continue typing..."})]}),e.jsxs(a,{justify:"end",gap:"2",align:"center",children:[e.jsx(me,{options:[10,20,50,100],selectedValue:u,updateValue:y=>V(y)}),e.jsx(ge,{rowsPerPage:u,start:g,totalRows:(P=x==null?void 0:x.message)!=null?P:0,gotoNextPage:()=>W(),gotoPreviousPage:()=>G()})]})]}),e.jsx(L,{error:z}),e.jsx(L,{error:R}),!d&&!z&&e.jsx(ue,{columns:3}),d&&d.message.length===0&&(s.length>=2||s.length==0)&&e.jsxs(a,{align:"center",justify:"center",direction:"column",gap:"2",className:"min-h-[32rem]",children:[e.jsx(he,{size:"3",children:"Nothing to see here"}),e.jsx(j,{size:"2",align:"center",children:"No files found in this channel"})]}),d&&d.message.length!==0&&e.jsx(Pe,{data:d.message})]})]})};export{Je as default};
