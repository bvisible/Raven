var Q=Object.defineProperty,X=Object.defineProperties;var Y=Object.getOwnPropertyDescriptors;var B=Object.getOwnPropertySymbols;var Z=Object.prototype.hasOwnProperty,R=Object.prototype.propertyIsEnumerable;var V=(r,a,s)=>a in r?Q(r,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):r[a]=s,w=(r,a)=>{for(var s in a||(a={}))Z.call(a,s)&&V(r,s,a[s]);if(B)for(var s of B(a))R.call(a,s)&&V(r,s,a[s]);return r},S=(r,a)=>X(r,Y(a));var q=(r,a,s)=>new Promise((d,o)=>{var n=i=>{try{t(s.next(i))}catch(m){o(m)}},u=i=>{try{t(s.throw(i))}catch(m){o(m)}},t=i=>i.done?d(i.value):Promise.resolve(i.value).then(n,u);t((s=s.apply(r,a)).next())});import{u as U,D as G,g as F,j as e,p as E,a as c,i as j,b as M,c as N,o as g,d as J,G as T,B as A,k as W,r as z,l as ee,L as D,m as ae,n as re,q as se,s as te,e as I,f as _,S as ie,t as ce,v as ne}from"./index-BeJbNZtk.js";import{A as le}from"./AuthContainer-BXl_-qSv.js";import{D as de}from"./DateSeparator-Drkboek_.js";const oe={Email:"Email",SMS:"SMS","OTP App":"OTP"},me=({loginWithTwoFAResponse:r,setError:a,setIsTwoFactorEnabled:s})=>{var f,p;const{register:d,handleSubmit:o,formState:{errors:n,isSubmitting:u}}=U(),{login:t}=G(),{appearance:i}=F();function m(h){return q(this,null,function*(){var b,y;a(null);const L={tmp_id:(b=r==null?void 0:r.tmp_id)!=null?b:"",otp:(y=h.otp)!=null?y:""};return t(L).then(x=>{window.location.replace("/raven")}).catch(x=>a(x))})}const k=h=>h.method==="Email"||h.method==="SMS"?h.prompt:"Enter Code displayed in OTP App.";return e.jsx(E,{children:e.jsx("form",{onSubmit:o(m),children:e.jsxs(c,{direction:"column",gap:"4",width:"100%",children:[e.jsx(c,{direction:"column",gap:"2",children:e.jsx(E,{children:e.jsx(j,{size:"3",color:"gray",children:(f=r==null?void 0:r.verification)!=null&&f.setup?k(r==null?void 0:r.verification):`Verification ${oe[(p=r==null?void 0:r.verification)==null?void 0:p.method]} not sent. Please contact Administrator.`})})}),e.jsxs(c,{direction:"column",gap:"4",children:[e.jsx(M,S(w({},d("otp",{required:"Verification Code is required."})),{name:"otp",type:"text",size:"3",variant:i==="dark"?"soft":void 0,color:"gray",required:!0,placeholder:"Verification Code",autoFocus:!0,tabIndex:0})),(n==null?void 0:n.otp)&&e.jsx(N,{children:n==null?void 0:n.otp.message})]}),e.jsx(c,{direction:"column",gap:"4",my:"2",children:e.jsx(g,{type:"submit",className:"not-cal font-medium",size:"3",children:u?e.jsx(J,{className:"text-white"}):"Verify"})}),e.jsx(c,{direction:"column",gap:"4",children:e.jsx(g,{className:"not-cal font-medium border-0 hover:bg-transparent hover:text-gray-12",variant:"ghost",type:"button",size:"3",color:"gray",onClick:()=>s(!1),children:"Cancel"})})]})})})};function ue(r){return T({attr:{version:"1.1",x:"0px",y:"0px",viewBox:"0 0 48 48",enableBackground:"new 0 0 48 48"},child:[{tag:"path",attr:{fill:"#FFC107",d:`M43.611,20.083H42V20H24v8h11.303c-1.649,4.657-6.08,8-11.303,8c-6.627,0-12-5.373-12-12\r
	c0-6.627,5.373-12,12-12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657C34.046,6.053,29.268,4,24,4C12.955,4,4,12.955,4,24\r
	c0,11.045,8.955,20,20,20c11.045,0,20-8.955,20-20C44,22.659,43.862,21.35,43.611,20.083z`},child:[]},{tag:"path",attr:{fill:"#FF3D00",d:`M6.306,14.691l6.571,4.819C14.655,15.108,18.961,12,24,12c3.059,0,5.842,1.154,7.961,3.039l5.657-5.657\r
	C34.046,6.053,29.268,4,24,4C16.318,4,9.656,8.337,6.306,14.691z`},child:[]},{tag:"path",attr:{fill:"#4CAF50",d:`M24,44c5.166,0,9.86-1.977,13.409-5.192l-6.19-5.238C29.211,35.091,26.715,36,24,36\r
	c-5.202,0-9.619-3.317-11.283-7.946l-6.522,5.025C9.505,39.556,16.227,44,24,44z`},child:[]},{tag:"path",attr:{fill:"#1976D2",d:`M43.611,20.083H42V20H24v8h11.303c-0.792,2.237-2.231,4.166-4.087,5.571\r
	c0.001-0.001,0.002-0.001,0.003-0.002l6.19,5.238C36.971,39.205,44,34,44,24C44,22.659,43.862,21.35,43.611,20.083z`},child:[]}]})(r)}const H={github:e.jsx(W,{size:"24"}),google:e.jsx(ue,{size:"24"}),facebook:e.jsx(A,{size:"24",color:"#316FF6"})},he=()=>{var x,C,P,O;const{appearance:r}=F(),{data:a}=K(),[s,d]=z.useState(null),{login:o}=G(),{register:n,handleSubmit:u,formState:{errors:t,isSubmitting:i}}=U(),[m,k]=z.useState(!1),[f,p]=z.useState(!1),[h,L]=z.useState(null),b=()=>{k(!m)};function y(v){return q(this,null,function*(){var $;return d(null),($=a==null?void 0:a.message)!=null&&$.two_factor_is_enabled?o({username:v.email,password:v.password}).then(l=>{l!=null&&l.verification&&(l!=null&&l.tmp_id)&&(p(!0),L(l))}).catch(l=>d(l)):o({username:v.email,password:v.password}).then(()=>{window.location.replace("/raven")}).catch(l=>{d(l)})})}return e.jsxs(le,{children:[s&&e.jsx(ee,{children:s.message}),f?e.jsx(me,{loginWithTwoFAResponse:h,setError:d,setIsTwoFactorEnabled:p}):e.jsx(E,{children:e.jsx("form",{onSubmit:u(y),children:e.jsx(c,{direction:"column",gap:"6",children:e.jsxs(c,{direction:"column",gap:"4",children:[e.jsxs(c,{direction:"column",gap:"2",children:[e.jsx(D,{htmlFor:"email",isRequired:!0,size:"3",children:(x=a==null?void 0:a.message)==null?void 0:x.login_label}),e.jsx(M,S(w({},n("email",{required:`${(C=a==null?void 0:a.message)==null?void 0:C.login_label} is required.`})),{name:"email",type:"text",required:!0,id:"email",size:"3",color:"gray",variant:r==="dark"?"soft":void 0,placeholder:"jane@example.com",tabIndex:0})),(t==null?void 0:t.email)&&e.jsx(N,{children:t==null?void 0:t.email.message})]}),e.jsxs(c,{direction:"column",gap:"2",children:[e.jsx(D,{htmlFor:"password",isRequired:!0,size:"3",children:"Password"}),e.jsx(M,S(w({},n("password",{required:"Password is required."})),{name:"password",type:m?"text":"password",autoComplete:"current-password",required:!0,id:"password",size:"3",variant:r==="dark"?"soft":void 0,placeholder:"***********",color:"gray",children:e.jsx(ae,{side:"right",children:e.jsx(re,{type:"button",size:"1",variant:"ghost","aria-label":m?"Mask password":"Reveal password",onClick:b,tabIndex:-1,children:m?e.jsx(se,{}):e.jsx(te,{})})})})),(t==null?void 0:t.password)&&e.jsx(N,{children:(P=t.password)==null?void 0:P.message}),e.jsx(c,{direction:"column",gap:"2",align:"end",children:e.jsx(I,{asChild:!0,color:"gray",size:"2",children:e.jsx(_,{to:"/forgot-password",children:"Forgot Password?"})})})]}),e.jsx(c,{direction:"column",gap:"2",children:e.jsx(g,{type:"submit",disabled:i,size:"3",className:"not-cal font-medium",children:i?e.jsx(J,{className:"text-white"}):"Login"})})]})})})}),e.jsx(pe,{isSubmitting:i}),((O=a==null?void 0:a.message)==null?void 0:O.disable_signup)===0?e.jsxs(c,{gap:"1",justify:"center",children:[e.jsx(j,{size:"2",color:"gray",children:"Don't have an account yet?"}),e.jsx(I,{size:"2",asChild:!0,children:e.jsx(_,{to:"/signup",children:e.jsx(j,{children:"Sign Up"})})})]}):null]})},K=()=>ne("raven.api.login.get_context",{"redirect-to":"/raven"},"raven.api.login.get_context",{revalidateOnMount:!0,revalidateOnReconnect:!1,revalidateOnFocus:!1}),pe=({isSubmitting:r})=>{var s,d,o,n,u;const{data:a}=K();return e.jsxs(ie,{gap:"3",children:[(s=a==null?void 0:a.message)!=null&&s.login_with_email_link||(d=a==null?void 0:a.message)!=null&&d.social_login?e.jsx(c,{justify:"center",className:"mt-1 mb-5 w-full",children:e.jsx(de,{className:"w-full",children:e.jsx(j,{size:"2",color:"gray",className:"uppercase",children:"or"})})}):null,(o=a==null?void 0:a.message)!=null&&o.social_login?(n=a==null?void 0:a.message)==null?void 0:n.provider_logins.map((t,i)=>e.jsx(c,{direction:"column",children:e.jsx(g,{size:"3",color:"gray",variant:"outline",className:"not-cal font-medium text-gray-12 dark:text-white",disabled:r,asChild:!0,children:e.jsxs(_,{to:t.auth_url,className:"flex items-center",children:[H[t.name]?H[t.name]:e.jsx("img",{src:t.icon.src,alt:t.icon.alt,style:{width:"20px",height:"20px"}}),"Continue with ",t.provider_name]})})},i)):null,(u=a==null?void 0:a.message)!=null&&u.login_with_email_link?e.jsx(c,{direction:"column",children:e.jsx(g,{type:"button",asChild:!0,size:"3",color:"gray",variant:"outline",className:"not-cal font-medium text-gray-12 dark:text-white",disabled:r,children:e.jsxs(_,{to:"/login-with-email",children:[e.jsx(ce,{size:"24"}),e.jsx(j,{children:"Login with Email Link"})]})})}):null]})};he.displayName="LoginPage";export{he as Component,pe as OtherLoginMethods,H as SocialProviderIcons};
