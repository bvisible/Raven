var Q=Object.defineProperty,X=Object.defineProperties;var Z=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var ee=Object.prototype.hasOwnProperty,se=Object.prototype.propertyIsEnumerable;var R=(a,s,n)=>s in a?Q(a,s,{enumerable:!0,configurable:!0,writable:!0,value:n}):a[s]=n,u=(a,s)=>{for(var n in s||(s={}))ee.call(s,n)&&R(a,n,s[n]);if(O)for(var n of O(s))se.call(s,n)&&R(a,n,s[n]);return a},C=(a,s)=>X(a,Z(s));import{r as g,j as e,ak as ae,al as ne,n as S,bk as re,an as te,ao as F,bp as oe,bq as le,a6 as M,aa as T,ad as E,ag as U,bd as W,bm as V,V as ie,aC as ce,Y as de,au as he,aM as me,av as xe,S as m,E as f,p as j,L as k,b as B,ax as y,ay as pe,o as x,d as N,br as je,a0 as q,bs as H,a1 as G,a3 as I,aJ as J,bt as ue,a as v,a4 as ge,a5 as be,a7 as Y,a8 as ve,a9 as ke,ab as K,ae as fe,af as ye,a2 as we,aj as Ce,bu as _e,c as De,aP as P,bv as Se,i as _,_ as D,bw as $,aH as We,aS as Ne,bx as Ie,by as Oe,F as Re,ah as Fe,u as Pe,ai as $e,bz as ze,bA as Le}from"./index-DhM1aug3.js";import{U as Ae}from"./UploadImageModal-CPOTo2fR.js";import{W as Me}from"./WorkspaceMemberManagement-Cwb6nt6j.js";import{P as Te,S as Ee,a as Ue}from"./SettingsContentContainer-DRsK0C7S.js";import{a as Ve}from"./validations-DJFqvO1k.js";import{m as Be,b as qe,P as z,f as L}from"./tabs-Dy4pJYvb.js";import"./index-C7EsiVMq.js";import"./table-DGmDSk0U.js";import"./TableLoader-8HqOeBd6.js";import"./Skeleton-CwvUWy7X.js";import"./useGetUserRecords-CVrS3xnU.js";import"./hover-card-CQZySoZy.js";const He=({workspaceID:a,workspaceName:s})=>{const[n,r]=g.useState(!1),[t,o]=g.useState(!1);return e.jsxs(e.Fragment,{children:[e.jsxs(ae,{children:[e.jsx(ne,{children:e.jsx(S,{type:"button",color:"gray",variant:"soft",children:e.jsx(re,{})})}),e.jsxs(te,{children:[e.jsxs(F,{onClick:()=>r(!0),children:[e.jsx(oe,{}),"Rename"]}),e.jsxs(F,{color:"red",onClick:()=>o(!0),children:[e.jsx(le,{}),"Delete"]})]})]}),e.jsx(M,{open:n,onOpenChange:r,children:e.jsx(T,{children:e.jsx(Ge,{onOpenChange:r,workspaceID:a,workspaceName:s})})}),e.jsx(E,{open:t,onOpenChange:o,children:e.jsx(U,{children:e.jsx(Je,{onOpenChange:o,workspaceID:a,workspaceName:s})})})]})},Ge=({onOpenChange:a,workspaceID:s,workspaceName:n})=>{const[r,t]=g.useState(n),{mutate:o}=W(),c=V(),{call:i,loading:l,error:d}=ie("frappe.model.rename_doc.update_document_title"),[h,p]=ce(de),w=()=>{i({doctype:"Raven Workspace",docname:s,name:r,merge:0}).then(b=>{I.success("Workspace renamed"),o("workspaces_list"),a(!1),h===s&&p(b.message),c("../"+b.message,{replace:!0})})};return e.jsxs(e.Fragment,{children:[e.jsx(he,{children:"Rename Workspace"}),e.jsx(me,{children:e.jsx(xe,{children:"Select a new name for your workspace"})}),e.jsxs(m,{children:[e.jsx(f,{error:d}),e.jsxs(j,{children:[e.jsx(k,{children:"Select a new name for your workspace"}),e.jsx(B,{required:!0,value:r,onChange:b=>t(b.target.value)})]})]}),e.jsxs(y,{pt:"4",justify:"end",children:[e.jsx(pe,{children:e.jsx(x,{color:"gray",variant:"soft",disabled:l,type:"button",children:"Close"})}),e.jsxs(x,{disabled:l,onClick:w,type:"button",children:[l&&e.jsx(N,{className:"text-white"}),l?"Renaming...":"Rename"]})]})]})},Je=({onOpenChange:a,workspaceID:s,workspaceName:n})=>{const{mutate:r}=W(),t=V(),{deleteDoc:o,error:c,loading:i}=je(),[l,d]=g.useState(""),h=l===n,p=()=>{h&&o("Raven Workspace",s).then(()=>{I.success("Workspace deleted"),a(!1),r("workspaces_list"),t("../",{replace:!0})})};return e.jsxs(e.Fragment,{children:[e.jsxs(q,{children:["Delete ",n,"?"]}),e.jsx(H,{size:"2",children:"Are you sure you want to delete this workspace? If you proceed, all channels, threads and messages within the workspace will be deleted. This action cannot be undone."}),e.jsxs(m,{pt:"2",children:[e.jsx(f,{error:c}),e.jsxs(j,{children:[e.jsx(k,{htmlFor:"delete-workspace-name",children:"Enter the workspace name to confirm deletion"}),e.jsx(B,{id:"delete-workspace-name",value:l,onChange:w=>d(w.target.value),placeholder:n})]}),e.jsxs(y,{pt:"2",justify:"end",children:[e.jsx(G,{children:e.jsx(x,{color:"gray",variant:"soft",disabled:i,children:"Cancel"})}),e.jsxs(x,{color:"red",disabled:i||!h,onClick:p,children:[i&&e.jsx(N,{className:"text-white"}),i?"Deleting...":"Delete"]})]})]})]})},Ye=()=>{const{control:a,watch:s}=J(),n=s("name"),{field:{value:r,onChange:t}}=ue({control:a,name:"logo"}),[o,c]=g.useState(!1),i=()=>{t("")},l=d=>{d&&t(d),c(!1)};return e.jsx(v,{direction:"column",gap:"3",children:e.jsxs(j,{className:"relative",children:[r?e.jsx("img",{src:r,alt:"Workspace Logo",className:"object-cover h-32 w-32 rounded-xl"}):e.jsx(ge,{alt:n,size:"9",fallback:be(n),className:"h-44 w-44"}),e.jsx(Ke,{open:o,setOpen:c,uploadImage:l,workspaceID:n}),r&&e.jsx(Qe,{onDelete:i})]})})},Ke=({open:a,setOpen:s,uploadImage:n,workspaceID:r})=>e.jsxs(M,{open:a,onOpenChange:s,children:[e.jsx(Y,{content:"Upload Image",side:"right",children:e.jsx(ve,{children:e.jsx(S,{type:"button","aria-label":"upload image",size:"1",className:"absolute -right-2 -bottom-1 rounded-md shadow-md",children:e.jsx(ke,{size:"12"})})})}),e.jsx(T,{className:K,children:e.jsx(Ae,{isPrivate:!1,uploadImage:n,doctype:"Raven Workspace",docname:r,fieldname:"logo"})})]}),Qe=({onDelete:a})=>e.jsxs(E,{children:[e.jsx(Y,{content:"Remove Image",side:"right",children:e.jsx(fe,{children:e.jsx(S,{type:"button","aria-label":"remove image",size:"1",className:"absolute -right-2 bottom-6 rounded-md bg-white dark:bg-slate-4 shadow-md",children:e.jsx(ye,{size:"12",color:"tomato"})})})}),e.jsxs(U,{className:K,maxWidth:"450px",children:[e.jsx(q,{children:"Remove logo"}),e.jsx(H,{size:"2",children:"Are you sure you want to remove the logo?"}),e.jsxs(y,{gap:"2",justify:"end",mt:"4",children:[e.jsx(G,{children:e.jsx(x,{variant:"soft",color:"gray",children:"Cancel"})}),e.jsx(we,{children:e.jsx(x,{variant:"solid",color:"red",onClick:a,children:"Delete"})})]})]})]}),Xe=()=>{var r;const{register:a,formState:{errors:s},control:n}=J();return e.jsx(Ce,{className:"p-0 align-middle justify-center",children:e.jsxs(m,{children:[e.jsx(j,{className:"flex justify-center w-full items-center bg-slate-2 dark:bg-slate-3 py-6",children:e.jsx(Ye,{})}),e.jsxs(m,{width:"100%",px:"4",pb:"4",gap:"4",children:[e.jsxs(m,{className:"max-w-lg",children:[e.jsxs(j,{children:[e.jsx(k,{htmlFor:"description",children:"Description"}),e.jsx(_e,C(u({id:"description"},a("description")),{rows:2,resize:"vertical",placeholder:"What is this workspace for?","aria-invalid":s.description?"true":"false"}))]}),s.description&&e.jsx(De,{children:(r=s.description)==null?void 0:r.message})]}),e.jsxs(m,{className:"max-w-lg",children:[e.jsx(k,{htmlFor:"channel_type",children:"Workspace Type"}),e.jsx(P,{name:"type",control:n,render:({field:t})=>e.jsx(Se,{defaultValue:"1",variant:"soft",id:"channel_type",value:t.value,onValueChange:t.onChange,children:e.jsxs(v,{gap:"4",children:[e.jsx(_,{as:"label",size:"2",children:e.jsxs(v,{gap:"2",children:[e.jsx($,{value:"Public"})," ",D("Public")]})}),e.jsx(_,{as:"label",size:"2",children:e.jsxs(v,{gap:"2",children:[e.jsx($,{value:"Private"})," ",D("Private")]})})]})})}),e.jsx(We,{children:D(`When a workspace is set to private, it can only be viewed or joined by invitation.
When a workspace is set to public, anyone can join the workspace and view it's channels.`)})]}),e.jsx(m,{className:"max-w-lg",children:e.jsxs(_,{as:"label",size:"2",children:[e.jsx(P,{control:n,name:"only_admins_can_create_channels",render:({field:{value:t,onChange:o,onBlur:c,name:i,disabled:l,ref:d}})=>e.jsx(Ne,{checked:!!t,disabled:l,name:i,"aria-invalid":s.only_admins_can_create_channels?"true":"false","aria-describedby":s.only_admins_can_create_channels?"only-admins-can-create-channels-error":void 0,"aria-required":s.only_admins_can_create_channels?"true":"false",onBlur:c,ref:d,onCheckedChange:h=>o(h?1:0)})}),"Â  Only admins can create channels in this workspace?"]})})]})]})})},A={size:18,className:"mr-1.5"},Ze=()=>{const{ID:a}=Ie(),{data:s,isLoading:n,error:r,mutate:t}=Oe("Raven Workspace",a);return e.jsxs(Te,{children:[e.jsx(f,{error:r}),n&&e.jsx(Re,{className:"h-64"}),s&&e.jsx(es,{data:s,mutate:t})]})},es=({data:a,mutate:s})=>{const{updateDoc:n,loading:r,error:t}=Fe(),o=Pe({defaultValues:a}),{formState:{dirtyFields:c}}=o,i=!Ve(c),{mutate:l}=W(),d=h=>{n("Raven Workspace",h.name,h).then(p=>{I.success("Saved"),o.reset(p),l("workspaces_list"),l("channel_list"),s(p,{revalidate:!1})})};return e.jsx("form",{onSubmit:o.handleSubmit(d),children:e.jsx($e,C(u({},o),{children:e.jsxs(Ee,{children:[e.jsx(Ue,{title:a.workspace_name,headerBadges:i?[{label:"Not Saved",color:"red"}]:void 0,actions:e.jsxs(y,{children:[e.jsx(He,{workspaceID:a.name,workspaceName:a.workspace_name}),e.jsxs(x,{type:"submit",disabled:r,children:[r&&e.jsx(N,{className:"text-white"}),r?"Saving":"Save"]})]}),breadcrumbs:[{label:"Workspaces",href:"../"},{label:a.workspace_name,href:"",copyToClipboard:!0}]}),e.jsx(f,{error:t}),a&&e.jsxs(Be,{defaultValue:"details",children:[e.jsxs(qe,{children:[e.jsxs(z,{value:"details",children:[e.jsx(ze,u({},A))," Details"]}),e.jsxs(z,{value:"members",children:[e.jsx(Le,u({},A))," Members"]})]}),e.jsxs(j,{pt:"4",children:[e.jsx(L,{value:"details",children:e.jsx(Xe,{})}),e.jsx(L,{value:"members",children:e.jsx(Me,{workspaceID:a.name})})]})]})]})}))})},ps=Ze;export{ps as Component};
